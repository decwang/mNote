<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2015-09-22T01:25:14Z"/><meta name="updated" content="2016-10-08T09:09:07Z"/><title> iOS GIF 格式动画 图片显示     分类： iOS2014-02-09 23:04 4432人阅读 评论(1) 收藏 举报  ios动画uiimageview图片  在 iOS 开发中，我</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div class="article_title" style="margin:5px 0px;font-size:20px;line-height:30px;font-family:'Microsoft YaHei';">&nbsp;<h1 style="margin:0px;padding:0px;display:inline;font-weight:normal;font-size:20px;vertical-align:middle;"><span class="link_title"><a href="http://blog.csdn.net/langya393645864/article/details/19019283" style="color:#333333;text-decoration:none;">iOS GIF 格式动画 图片显示&nbsp;</a></span></h1>
</div>
<div class="article_manage" style="padding:5px 0px;color:#999999;font-size:12px;line-height:24px;font-family:Arial;text-align:right;"><span class="link_categories" style="margin:0px 5px;float:left;">分类：&nbsp;<a href="http://blog.csdn.net/langya393645864/article/category/1879105" style="color:#ff9900;text-decoration:none;">iOS</a></span><span class="link_postdate" style="margin:0px 5px 0px 0px;">2014-02-09 23:04</span>&nbsp;<span class="link_view" title="阅读次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background-image:url(http://static.blog.csdn.net/images/ico_view.png);background-position:0% 50%;background-repeat:no-repeat no-repeat;">4432人阅读</span>&nbsp;<span class="link_comments" title="评论次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background-image:url(http://static.blog.csdn.net/images/ico_comm.png);background-position:0% 50%;background-repeat:no-repeat no-repeat;"><a href="http://blog.csdn.net/langya393645864/article/details/19019283#comments" style="color:#ff9900;text-decoration:none;">评论</a>(1)</span>&nbsp;<span class="link_collect" style="margin:0px 5px;"><a title="收藏" style="color:#ff9900;">收藏</a></span>&nbsp;<span class="link_report" style="margin:0px 5px;"><a href="http://blog.csdn.net/langya393645864/article/details/19019283#report" title="举报" style="color:#ff9900;text-decoration:none;">举报</a></span></div>
<div class="tag2box" style="margin:10px 0px;font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;line-height:normal;"><a href="http://www.csdn.net/tag/ios" target="_blank" style="color:#ff9900;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">ios</a><a href="http://www.csdn.net/tag/%e5%8a%a8%e7%94%bb" target="_blank" style="color:#ff9900;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">动画</a><a href="http://www.csdn.net/tag/uiimageview" target="_blank" style="color:#ff9900;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">uiimageview</a><a href="http://www.csdn.net/tag/%e5%9b%be%e7%89%87" target="_blank" style="color:#ff9900;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">图片</a></div>
<div id="article_content" class="article_content" style="margin:20px 0px 0px;line-height:26px;font-family:Arial;"><p style="margin-top:0px;margin-bottom:0px;padding:0px;">在 iOS 开发中，我们常使用 SDK 中的 UIImageView 显示图片，使用 UIImage 解码图片文件或数据，其支持 PNG， JEPG， BMP， GIF 等格式。其中 GIF 图片不支持动画。</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">如果中 iOS 中显示 GIF 动画图片，则需要自己实现。具体实现方式很简单，使用 SDK 中的 Image I/O framework 解码图片，读取 GIF 动画图片的帧数，显示时间。</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">然后使用 SDK 中的 quartzcore framework 中的 core animation 的 CAKeyFrameAnimation 类对 CALayer 执行动画。&nbsp;</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">1. 解码图片，在 &nbsp;<a target="_blank" href="http://blog.csdn.net/langya393645864/article/details/18864313" style="color:#ff9900;text-decoration:none;">iOS Create an CGImageSource</a>&nbsp;文章已经介绍了如何使用 Image I/O framework 进行图片解码。</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">2. 读取 GIF 动画图片的每一帧图片及显示时间，并保存成数组：</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.53125px;overflow:auto;padding-top:1px;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/langya393645864/article/details/19019283#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><a href="http://blog.csdn.net/langya393645864/article/details/19019283#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><a href="https://code.csdn.net/snippets/181646" target="_blank" title="在CODE上查看代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/CODE_ico.png" width="12" height="12" alt="在CODE上查看代码片" style="border:none;position:relative;top:1px;left:2px;" /></a><a href="https://code.csdn.net/snippets/181646/fork" target="_blank" title="派生到我的代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/ico_fork.svg" width="12" height="12" alt="派生到我的代码片" style="border:none;position:relative;top:2px;left:2px;" /></a><div style="position:absolute;left:367px;top:668px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_1" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=18&amp;height=18" wmode="transparent" /></div>
</div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">size_t</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;imageCount&nbsp;=&nbsp;CGImageSourceGetCount(cImageSource);&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSMutableArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*images&nbsp;=&nbsp;[[NSMutableArray</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;alloc</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;initWithCapacity</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:imageCount];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSMutableArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*times&nbsp;=&nbsp;[[NSMutableArray</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;alloc</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;initWithCapacity</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:imageCount];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSMutableArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*keyTimes&nbsp;=&nbsp;[[NSMutableArray</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;alloc</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;initWithCapacity</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:imageCount];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">float</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;totalTime&nbsp;=&nbsp;</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">for</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">size_t</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;i&nbsp;=&nbsp;</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;i&nbsp;&lt;&nbsp;imageCount;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CGImageRef&nbsp;cgimage=&nbsp;CGImageSourceCreateImageAtIndex(cImageSource,&nbsp;i,&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NULL</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[images<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;addObject</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(__bridge&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">id</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)cgimage];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CGImageRelease(cgimage);&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSDictionary</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*properties&nbsp;=&nbsp;(__bridge&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSDictionary</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)CGImageSourceCopyPropertiesAtIndex(cImageSource,&nbsp;i,&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NULL</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSDictionary</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*gifProperties&nbsp;=&nbsp;[properties</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;valueForKey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(__bridge&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSString</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)kCGImagePropertyGIFDictionary];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSString</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*gifDelayTime&nbsp;=&nbsp;[gifProperties</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;valueForKey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(__bridge&nbsp;NSString*&nbsp;)kCGImagePropertyGIFDelayTime];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[times<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;addObject</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:gifDelayTime];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalTime&nbsp;+=&nbsp;[gifDelayTime<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;floatValue</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_size<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.width</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;[[properties</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;valueForKey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(NSString*)kCGImagePropertyPixelWidth]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;floatValue</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_size<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.height</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;[[properties</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;valueForKey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(NSString*)kCGImagePropertyPixelHeight]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;floatValue</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">float</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;currentTime&nbsp;=&nbsp;</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">for</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">size_t</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;i&nbsp;=&nbsp;</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;i&nbsp;&lt;&nbsp;times</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.count</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">float</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;keyTime&nbsp;=&nbsp;currentTime&nbsp;/&nbsp;totalTime;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[keyTimes<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;addObject</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:[NSNumber</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;numberWithFloat</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:keyTime]];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentTime&nbsp;+=&nbsp;[[times<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;objectAtIndex</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:i]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;floatValue</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
</ol>
</div>
<br />
3. 执行 CAKeyFrameAnimation 动画<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.53125px;overflow:auto;padding-top:1px;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/langya393645864/article/details/19019283#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><a href="http://blog.csdn.net/langya393645864/article/details/19019283#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><a href="https://code.csdn.net/snippets/181646" target="_blank" title="在CODE上查看代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/CODE_ico.png" width="12" height="12" alt="在CODE上查看代码片" style="border:none;position:relative;top:1px;left:2px;" /></a><a href="https://code.csdn.net/snippets/181646/fork" target="_blank" title="派生到我的代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/ico_fork.svg" width="12" height="12" alt="派生到我的代码片" style="border:none;position:relative;top:2px;left:2px;" /></a><div style="position:absolute;left:367px;top:1365px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_2" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_2" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=18&amp;height=18" wmode="transparent" /></div>
</div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CAKeyframeAnimation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*animation&nbsp;=&nbsp;[CAKeyframeAnimation</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;animationWithKeyPath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"contents"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[animation<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;setTimingFunction</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:[CAMediaTimingFunction</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;functionWithName</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:kCAMediaTimingFunctionLinear]];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[animation<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;setValues</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:images];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[animation<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;setKeyTimes</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:keyTimes];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;animation<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.duration</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;totalTime;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;animation<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.repeatCount</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;HUGE_VALF;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.layer</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;addAnimation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:animation</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;forKey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"gifAnimation"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<br />
完成！</div></body></html>