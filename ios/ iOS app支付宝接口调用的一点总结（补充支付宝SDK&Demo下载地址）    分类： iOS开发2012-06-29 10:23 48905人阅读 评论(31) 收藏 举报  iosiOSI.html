<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2014-11-28T12:31:17Z"/><meta name="updated" content="2014-11-28T12:31:19Z"/><title> iOS app支付宝接口调用的一点总结（补充支付宝SDK&Demo下载地址）    分类： iOS开发2012-06-29 10:23 48905人阅读 评论(31) 收藏 举报  iosiOSI</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div class="article_title" style="margin:5px 0px;font-size:20px;line-height:30px;font-family:'Microsoft YaHei';">&nbsp;<h1 style="margin:0px;padding:0px;display:inline;font-weight:normal;font-size:20px;vertical-align:middle;"><span class="link_title"><a href="http://blog.csdn.net/sing_sing/article/details/7701418" style="color:#000000;text-decoration:none;">iOS app支付宝接口调用的一点总结（补充支付宝SDK&amp;Demo下载地址）</a></span></h1>
</div>
<div class="article_manage" style="padding:5px 0px;color:#999999;font-size:12px;line-height:24px;font-family:Arial;text-align:right;"><span class="link_categories" style="margin:0px 5px;float:left;">分类：&nbsp;<a href="http://blog.csdn.net/sing_sing/article/category/821127" style="color:#336699;text-decoration:none;">iOS开发</a></span><span class="link_postdate" style="margin:0px 5px 0px 0px;">2012-06-29 10:23</span>&nbsp;<span class="link_view" title="阅读次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background-image:url(http://static.blog.csdn.net/images/ico_view.png);background-position:0% 50%;background-repeat:no-repeat no-repeat;">48905人阅读</span>&nbsp;<span class="link_comments" title="评论次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background-image:url(http://static.blog.csdn.net/images/ico_comm.png);background-position:0% 50%;background-repeat:no-repeat no-repeat;"><a href="http://blog.csdn.net/sing_sing/article/details/7701418#comments" style="color:#336699;text-decoration:none;">评论</a>(31)</span>&nbsp;<span class="link_collect" style="margin:0px 5px;"><a title="收藏" style="color:#336699;">收藏</a></span>&nbsp;<span class="link_report" style="margin:0px 5px;"><a href="http://blog.csdn.net/sing_sing/article/details/7701418#report" title="举报" style="color:#336699;text-decoration:none;">举报</a></span></div>
<div class="tag2box" style="margin:10px 0px;color:#333333;font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;line-height:normal;"><a href="http://www.csdn.net/tag/ios" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">ios</a><a href="http://www.csdn.net/tag/iOS" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">iOS</a><a href="http://www.csdn.net/tag/IOS" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">IOS</a><a href="http://www.csdn.net/tag/%e6%96%87%e6%a1%a3" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">文档</a><a href="http://www.csdn.net/tag/%e6%9c%8d%e5%8a%a1%e5%99%a8" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">服务器</a><a href="http://www.csdn.net/tag/%e6%b5%8b%e8%af%95" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">测试</a><a href="http://www.csdn.net/tag/%e7%94%b5%e8%af%9d" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;padding:4px 10px;line-height:12px;margin-right:10px;border:1px solid #eeeeee;background-color:#eeeeee;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;">电话</a></div>
<div id="article_content" class="article_content" style="margin:20px 0px 0px;line-height:26px;font-family:Arial;color:#333333;"><p>由于app内需要用到支付功能，选择了当前最流行的支付宝进行支付。在进行内嵌支付宝功能开发时，被它狠狠的耍了一把。</p>
<p>根据支付宝开发文档，参考demo代码。将相关支付功能加到了自己的代码中。一些根据文档来做，也没有太大的难度。但添加完代码，进行测试时，问题却来了。在app中可以成功调用支付宝app，成功支付并返回。这个时候就出现问题了。在app delegate支付宝回调本app的执行函数中，公钥验证签名成功后，会对支付结果进行提示。根据demo，提示支付的代码如下：</p>
<p></p>
<div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:700.90625px;overflow:auto;padding-top:1px;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[cpp]</b>&nbsp;<a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:475px;top:606px;width:18px;height:18px;z-index:99;"><div title="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" class="CTPnoimage CTPplaceholder" style="position:relative !important;width:18px !important;height:18px !important;top:auto !important;right:auto !important;bottom:auto !important;left:auto !important;z-index:auto !important;clear:none !important;float:none !important;vertical-align:-webkit-baseline-middle !important;margin:0px !important;-webkit-margin-before-collapse:collapse !important;-webkit-margin-after-collapse:collapse !important;"><div class="CTPplaceholderContainer" style="opacity:0.5 !important;"></div>
</div>
</div>
</div>
</div>
<ol start="1" class="dp-cpp" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">UIAlertView&nbsp;*&nbsp;alertView&nbsp;=&nbsp;[[UIAlertView&nbsp;alloc]&nbsp;initWithTitle:@</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"提示"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;message:result.statusMessage&nbsp;delegate:self&nbsp;cancelButtonTitle:@</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"确定"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;otherButtonTitles:nil];&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:700.90625px;overflow:auto;padding-top:1px;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[cpp]</b>&nbsp;<a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:475px;top:711px;width:18px;height:18px;z-index:99;"><div title="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" class="CTPnoimage CTPplaceholder" style="position:relative !important;width:18px !important;height:18px !important;top:auto !important;right:auto !important;bottom:auto !important;left:auto !important;z-index:auto !important;clear:none !important;float:none !important;vertical-align:-webkit-baseline-middle !important;margin:0px !important;-webkit-margin-before-collapse:collapse !important;-webkit-margin-after-collapse:collapse !important;"><div class="CTPplaceholderContainer" style="opacity:0.5 !important;"></div>
</div>
</div>
</div>
</div>
<ol start="1" class="dp-cpp" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">[alertView&nbsp;show];&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:700.90625px;overflow:auto;padding-top:1px;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[cpp]</b>&nbsp;<a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><a href="http://blog.csdn.net/sing_sing/article/details/7701418#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:475px;top:780px;width:18px;height:18px;z-index:99;"><div title="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" class="CTPnoimage CTPplaceholder" style="position:relative !important;width:18px !important;height:18px !important;top:auto !important;right:auto !important;bottom:auto !important;left:auto !important;z-index:auto !important;clear:none !important;float:none !important;vertical-align:-webkit-baseline-middle !important;margin:0px !important;-webkit-margin-before-collapse:collapse !important;-webkit-margin-after-collapse:collapse !important;"><div class="CTPplaceholderContainer" style="opacity:0.5 !important;"></div>
</div>
</div>
</div>
</div>
<ol start="1" class="dp-cpp" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">[alertView&nbsp;release];&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<br />
问题就出现在这里了。支付成功后，result.statusMessage返回的值却是空的。而我测试取消支付，这个返回值却是正确的，提示“操作取消”之类的文字（具体忘记了）。支付失败没有进行测试。这下麻烦了，不知问题出在哪里。总不能支付成功后，返回一个空的提示吧。或者直接将提示自己写死，显示“支付成功”？那万一是其他信息提示咋办呢？<p></p>
<p>重复对比了demo和自己程序的代码，发现没有错漏的地方。百思不得其解，于是想是不是支付宝后台的问题？又根据支付宝服务器端的开发文档，仔细检查，反复测试了。还是找不到原因。</p>
<p>这下没撤了，只能打支持电话，加入一个交流群，问了支付宝负责技术的人，反复说明问题后，终于得到了答覆，支付成功时，result.statusMessage是没有返回值的，大概意思是后来取消了这个返回值。</p>
<p>我的妈阿，对返回值作了改变，为啥文档又没说明，让我等苦逼的程序猿白白折磨了一两天，情何以堪呢。客气的将我的想法提了给支付宝的技术支持，回复说：不要太相信demo。shit，这是人话吗，我用你的接口，不是根据你的文档和demo，那我会担心出错的，而且这是涉及到金钱问题，所以更加不能马虎。内心暗骂了一通之后，又将我的一番建议，例如要求再进一步完善文档，对细节再进一步谨慎之类的提交到支付宝技术支持那里。到此，我的痛苦的支付宝接口调用过程就告一段落了。写这篇文章，算是提醒自己或者有需要的人，有不明白的地方，第一时间找支付宝的技术支持，不要自己瞎折腾了，说不定你碰到的问题不是自己的问题，而是出在第三方接口上。</p>
<p>另外说一下，支付宝网站上找技术支持，直接点支持旺旺是没反应的，你需要打电话去问，才能拿到技术支持的旺旺号，这里公布一下支付宝技术支持群的旺旺号，应该不会被支付宝的人骂吧。呵呵</p>
<p>旺旺号：24768316&nbsp;<br />
密码：alipay2010</p>
<p><span style="font-size:24px;color:#ff0000;">补充：</span></p>
<p>另外，很多人发私信来问，哪里可以下载支付宝demo或者sdk。这个问题自己曾经也痛苦过，在支付宝网站找个demo，不是一般的难，位置隐藏得非常深，特别是改版后，更加难找了。上一次（改版后）实在找不到，只好问支付宝的技术支持。</p>
<p>支付宝集成sdk和demo下载地址：</p>
<p><a href="http://download.alipay.com/public/api/base/WS_SECURE_PAY.zip" style="color:#336699;text-decoration:none;">下载地址：http://download.alipay.com/public/api/base/WS_SECURE_PAY.zip</a></p>
<p>这个只是无线产品的集成sdk和demo，其他的产品没有用过，所以忽略。</p>
</div></body></html>