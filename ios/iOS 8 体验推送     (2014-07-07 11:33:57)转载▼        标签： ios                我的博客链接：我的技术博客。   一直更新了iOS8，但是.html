<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2014-10-23T06:18:03Z"/><meta name="updated" content="2014-10-23T06:18:05Z"/><title>iOS 8 体验推送     (2014-07-07 11:33:57)转载▼        标签： ios                我的博客链接：我的技术博客。   一直更新了iOS8，但是</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div class="articalTitle"> 
			
								<h2 id="t_626e5d690102uwvv" class="titName SG_txta">iOS&nbsp;8&nbsp;体验推送</h2>
			
					<span class="img2"> 				<img title="此博文包含图片" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon18" width="15" align="absmiddle" height="15" />	
			</span> 					<span class="time SG_txtc">(2014-07-07 11:33:57)</span><div class="turnBoxzz"><a href="" class="SG_aBtn SG_aBtn_ico SG_turn" action-type="reblog" action-data="{srcBlog:1, blogId:'626e5d690102uwvv'}"><cite><img class="SG_icon SG_icon111" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" align="absmiddle" height="15" />转载<em class="arrow">▼</em></cite></a></div>
		</div>
		<div class="articalTag" id="sina_keyword_ad_area">
			<table>
				<tbody><tr>
					<td class="blog_tag">
					
											<span class="SG_txtb">标签：</span> 																				<h3><a href="http://search.sina.com.cn/?c=blog&amp;q=ios&amp;by=tag" target="_blank">ios</a></h3>
																</td>
					<td class="blog_class">
										</td>
				</tr>
			</tbody>
</table>
		</div>
						
		<div id="sina_keyword_ad_area2" class="articalContent newfont_family">
			<p>我的博客链接：<a href="http://itmonkeylife.github.io/Blog/" target="_blank">我的技术博客</a>。</p>
<p>
一直更新了iOS8，但是一直没有开始研究这个iOS8，今天因为项目用到了推送，于是体验了iOS8的推送，先讲讲这个推送。目前分为四个推送：用户推送，本地推送，远程推送，地理位置推送。</p>
<p><img action-type="show-slide" action-data="http%3A%2F%2Fww3.sinaimg.cn%2Flarge%2F626e5d69gw1ehyeq298goj21kw0sadmt.jpg" exify_intitialized="true" src="http://ww3.sinaimg.cn/large/626e5d69gw1ehyeq298goj21kw0sadmt.jpg" real_src="http://ww3.sinaimg.cn/large/626e5d69gw1ehyeq298goj21kw0sadmt.jpg" alt="推送界面" name="image_operate_24051404704848354" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<h2>用户推送</h2>
<p>我们先开始讲这个用户推送,我们要使用之前必须先注册这个推送，用户要允许这个程序进行推送</p>
<p>注册过程：</p>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">BOOL</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didFinishLaunchingWithOp<wbr>tions:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSDictionary</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">launchOptions</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#93a1a1 !important;font-style:italic !important;">// Override point for customization after application launch.</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">  UIUserNotificationType</span>  <span style="margin:0px;padding:0px;color:#268bd2 !important;">types</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeBa<wbr>dge                                                                                                                      &nbsp;<wbr>&nbsp;<wbr></span><span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">|&nbsp;<wbr></span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeSo<wbr>und</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">|                                                                                       &nbsp;<wbr> &nbsp;<wbr> &nbsp;<wbr></span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeAl<wbr>ert</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">;</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">     UIUserNotificationSettin<wbr>gs</span>  <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">mySettings</span>  <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationSettin<wbr>gs</span> <span style="margin:0px;padding:0px;color:#859900 !important;">settingsForTypes:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">types</span> <span style="margin:0px;padding:0px;color:#859900 !important;">categories:</span><span style="margin:0px;padding:0px;color:#859900 !important;">nil</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">   [[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">sharedApplication</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#859900 !important;">registerUserNotification<wbr>Settings:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">mySettings</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">  return</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">YES</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didRegisterUserNotificat<wbr>ionSettings:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationSettin<wbr>gs</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notificationSettings</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">    UIUserNotificationType</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">allowTypes</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notificationSettings</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">types</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">getReadyForNotification</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">    UIUserNotificationSettin<wbr>gs</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">currentNotificationSetti<wbr>ngs</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">sharedApplication</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">currentUserNotificationS<wbr>ettings</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">  [</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">self</span> <span style="margin:0px;padding:0px;color:#859900 !important;">checkSetting:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">currentNotificationSetti<wbr>ngs</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <p>总结就是三个方法进行注册</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F626e5d69gw1ehyeumz8inj21f80d40up.jpg" src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyeumz8inj21f80d40up.jpg" real_src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyeumz8inj21f80d40up.jpg" alt="推送注册三个方法" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<p>我们现在仅仅是注册了通知的设置，还要注册推送通知的行为，在iOS8中，行为能直接在推送消息进行，如回复消息，拒绝消息等</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F626e5d69gw1ehyeyi825mj21aa12ggoc.jpg" src="http://ww1.sinaimg.cn/large/626e5d69gw1ehyeyi825mj21aa12ggoc.jpg" real_src="http://ww1.sinaimg.cn/large/626e5d69gw1ehyeyi825mj21aa12ggoc.jpg" alt="直接在推送消息进行回复" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<p>这个真心碉堡了</p>
<p>我们如何能进行这些行为，首先我们需注册这些行为。</p>
<ul>
<li>Actions<br />
<span style="font-size:0.9em;color:#333333;margin:0px;padding:0px;"> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIMutableUserNotificatio<wbr>nAction</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> *</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> =</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIMutableUserNotificatio<wbr>nAction</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">alloc</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">init</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span></span> <span style="font-size:0.9em;margin:0px;padding:0px;"><span style="color:#268bd2 !important;margin:0px;padding:0px;">acceptAction</span><span style="color:#586e75 !important;margin:0px;padding:0px;">.</span><span style="color:#268bd2 !important;margin:0px;padding:0px;">identifier</span> <span style="color:#586e75 !important;margin:0px;padding:0px;font-weight:bold !important;"> =</span> <span style="color:#2aa198 !important;margin:0px;padding:0px;">@"RickAction"</span><span style="color:#586e75 !important;margin:0px;padding:0px;">;</span><span style="color:#333333;">&nbsp;<wbr><br />
</span></span><span style="font-size:0.9em;color:#333333;margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">title</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> =</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">@"Accept"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span><br />
</span> <span style="font-size:0.9em;color:#333333;margin:0px;padding:0px;"> <span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">activationMode</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> =</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationActiva<wbr>tionModeBackground</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span><br />
</span> <span style="font-size:0.9em;color:#333333;margin:0px;padding:0px;"> <span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">destructive</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> =</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">NO</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span><br />
</span> <span style="font-size:0.9em;color:#333333;margin:0px;padding:0px;"> <span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">authenticationRequired</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;"> =</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">NO</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span></span></li>
<li>Categories<br />
</li>
</ul>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIMutableUserNotificatio<wbr>nCategory</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">inviteCategory</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIMutableUserNotificatio<wbr>nCategory</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">alloc</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">init</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">inviteCategory</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">identifier</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">@"INVITE_CATEGORY"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">inviteCategory</span> <span style="margin:0px;padding:0px;color:#859900 !important;">setActions:</span><span style="margin:0px;padding:0px;color:#dc322f !important;background:none !important;">@</span><span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">acceptAction</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#859900 !important;">forContext:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationAction<wbr>ContextDefault</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span></span></code> </pre> <p>
我们需要注意这个<code>UIUserNotificationAction<wbr>ContextDefault</code>,如果我们使用这个，我们会得到这个推送行为，Maybe和Accept</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F626e5d69gw1ehyf4bfhvrj20q80zytaw.jpg" src="http://ww1.sinaimg.cn/large/626e5d69gw1ehyf4bfhvrj20q80zytaw.jpg" real_src="http://ww1.sinaimg.cn/large/626e5d69gw1ehyf4bfhvrj20q80zytaw.jpg" alt="Maybe和Accept" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<p>
我们还可以使用<code>UIUserNotificationAction<wbr>ContextMinimal</code>得到的是Decline和Accept行为</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww3.sinaimg.cn%2Flarge%2F626e5d69gw1ehyf61ypo0j20q010476h.jpg" src="http://ww3.sinaimg.cn/large/626e5d69gw1ehyf61ypo0j20q010476h.jpg" real_src="http://ww3.sinaimg.cn/large/626e5d69gw1ehyf61ypo0j20q010476h.jpg" alt="Decline和Accept" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<ul>
<li>Settings</li>
</ul>
<p>在这些行为注册之后，我们加上之前提到的推送设置就完成了注册推送的这个流程了</p>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSSet</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">categories</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSSet</span> <span style="margin:0px;padding:0px;color:#859900 !important;">setWithObjects:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">inviteCategory</span><span style="margin:0px;padding:0px;color:#586e75 !important;">,</span> <span style="margin:0px;padding:0px;color:#859900 !important;">nil</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationType</span>  <span style="margin:0px;padding:0px;color:#268bd2 !important;">types</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeBa<wbr>dge</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">|</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeSo<wbr>und</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">|</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationTypeAl<wbr>ert</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">;</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationSettin<wbr>gs</span>  <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">mySettings</span>  <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIUserNotificationSettin<wbr>gs</span> <span style="margin:0px;padding:0px;color:#859900 !important;">settingsForTypes:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">types</span> <span style="margin:0px;padding:0px;color:#859900 !important;">categories:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">categories</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">sharedApplication</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#859900 !important;">registerUserNotification<wbr>Settings:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">mySettings</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span></span></code> </pre> 远程推送<p>远程推送，所有消息大小不超过2KB,我们获取远程推送的json格式的消息，解析这个消息就是我们的远程推送了：</p>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#dc322f !important;background:none !important;">“aps”:</span> <span style="margin:0px;padding:0px;color:#dc322f !important;background:none !important;">{</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">            "content-available"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">:</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">1</span><span style="margin:0px;padding:0px;color:#586e75 !important;">,</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">               "alert"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">:</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">"This is the alert text"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">,</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">            "badge"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">:</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">1</span><span style="margin:0px;padding:0px;color:#586e75 !important;">,</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">           "sound"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">:</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">"default"</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><span style="font-size:0.9em;margin:0px;padding:0px;background-color:initial;">            &nbsp;<wbr></span><span style="font-size:0.9em;margin:0px;padding:0px;background-color:initial;"><span style="margin:0px;padding:0px;color:#dc322f !important;background:none !important;">}</span></span> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"></pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-size:0.9em;margin:0px;padding:0px;background-color:initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code></span> </pre> <p>
若要使用远程推送，满足两个条件：一、用户需要调用注册用户推送<code>registerUserNotification<wbr>Settings</code>;二、在<code>info.plist</code>文件中<code>UIBackgroundModes</code>必须包含远程通知。</p>
<blockquote>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">sharedApplication</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">registerForRemoteNotific<wbr>ations</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span></span></code> </pre> <p>这个注册通知的方法开始更改了</p>
</blockquote>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didRegisterForRemoteNoti<wbr>ficationsWithDeviceToken<wbr>:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSData</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">deviceToken</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didFailToRegisterForRemo<wbr>teNotificationsWithError<wbr>:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSError</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">error</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <p>iOS7通知代理方法</p>
<p><img exify_intitialized="true" src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfq2omeij21kw0zc456.jpg" real_src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfq2omeij21kw0zc456.jpg" alt="iOS6的通知代理方法" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<p>后来又增加了本地通知的代理方法</p>
<p><img exify_intitialized="true" src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfvjws4ej21kw0uxn20.jpg" real_src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfvjws4ej21kw0uxn20.jpg" alt="添加本地推送的通知代理方法" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<p>iOS8的推送代理方法只有两个了</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F626e5d69gw1ehyfws0hdfj210g0oyq6d.jpg" src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfws0hdfj210g0oyq6d.jpg" real_src="http://ww4.sinaimg.cn/large/626e5d69gw1ehyfws0hdfj210g0oyq6d.jpg" alt="iOS 8推送的通知代理方法" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">handleActionWithIdentifi<wbr>er:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSString</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">identifier</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">forLocalNotification:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UILocalNotification</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">completionHandler:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">^</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)())</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">completionHandler</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">handleActionWithIdentifi<wbr>er:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSString</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">identifier</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">forRemoteNotification:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSDictionary</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">userInfo</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">completionHandler:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">^</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)())</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">completionHandler</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">handleActionWithIdentifi<wbr>er:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">NSString</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">identifier</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">forLocalNotification:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UILocalNotification</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">completionHandler:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">^</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)())</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">completionHandler</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#cb4b16 !important;">if</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">([</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">identifier</span> <span style="margin:0px;padding:0px;color:#859900 !important;">isEqualToString:</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">@"RickAction"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">])</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;">        <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">self</span> <span style="margin:0px;padding:0px;color:#859900 !important;">handleAcceptActionWithNo<wbr>tification:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#586e75 !important;">}</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#268bd2 !important;">completionHandler</span><span style="margin:0px;padding:0px;color:#586e75 !important;">();</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">handleAcceptActionWithNo<wbr>tification:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UILocalNotification</span><span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> 地理位置推送<p>这个推送是新的API才有的特性,必须配合CLLocation定位一起使用。</p>
<blockquote>
<pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#93a1a1 !important;font-style:italic !important;">//Location Notification</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#268bd2 !important;">CLLocationManager</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">locMan</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">CLLocationManager</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">alloc</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">init</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#268bd2 !important;">locMan</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">delegate</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">self</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#586e75 !important;">[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">locMan</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">requestWhenInUseAuthoriz<wbr>ation</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#93a1a1 !important;font-style:italic !important;">#pragma mark - CLLocationManager</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">locationManager:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">CLLocationManager</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">manager</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didChangeAuthorizationSt<wbr>atus:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">CLAuthorizationStatus</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">status</span> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#2aa198 !important;">BOOL</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">canUseLocationNotificati<wbr>ons</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">status</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">==</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">kCLAuthorizationStatusAu<wbr>thorizedWhenInUse</span><span style="margin:0px;padding:0px;color:#586e75 !important;">);</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#cb4b16 !important;">if</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">canUseLocationNotificati<wbr>ons</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">        [</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">self</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">startShowLocationNotific<wbr>ation</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;"> }</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">application:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">application</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">didReceiveLocalNotificat<wbr>ion:</span><span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UILocalNotification</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">    CLRegion</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">region</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">notification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">region</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">     if</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">region</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">{</span> </span><span style="margin:0px;padding:0px;">    <span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#cb4b16 !important;">-</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">(</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">void</span><span style="margin:0px;padding:0px;color:#586e75 !important;">)</span><span style="margin:0px;padding:0px;color:#268bd2 !important;font-weight:bold !important;">startShowLocationNotific<wbr>ation</span> </span><span style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">{</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">    CLLocationCoordinate2D</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">local2D</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">     local2D</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">latitude</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">123.0</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">        local2D</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">longitude</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">223.0</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">       UILocalNotification</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">*</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">locNotification</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UILocalNotification</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">alloc</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">init</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];       </span></span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;">locNotification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">alertBody</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#2aa198 !important;">@"你接收到了"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;"> locNotification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">regionTriggersOnce</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">YES</span><span style="margin:0px;padding:0px;color:#586e75 !important;">;</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#268bd2 !important;"> locNotification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">.</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">region</span> <span style="margin:0px;padding:0px;color:#586e75 !important;font-weight:bold !important;">=</span> <span style="margin:0px;padding:0px;color:#586e75 !important;">[[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">CLCircularRegion</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">alloc</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#859900 !important;">initWithCenter:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">local2D</span> <span style="margin:0px;padding:0px;color:#859900 !important;">radius:</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">45</span> <span style="margin:0px;padding:0px;color:#859900 !important;">identifier:</span><span style="margin:0px;padding:0px;color:#2aa198 !important;">@"local-identity"</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">        [[</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">UIApplication</span> <span style="margin:0px;padding:0px;color:#268bd2 !important;">sharedApplication</span><span style="margin:0px;padding:0px;color:#586e75 !important;">]</span> <span style="margin:0px;padding:0px;color:#859900 !important;">scheduleLocalNotificatio<wbr>n:</span><span style="margin:0px;padding:0px;color:#268bd2 !important;">locNotification</span><span style="margin:0px;padding:0px;color:#586e75 !important;">];</span>&nbsp;<wbr></span></code> </pre> <pre style="margin-top:0px;margin-bottom:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;line-height:1.5;overflow-x:auto;color:#333333;font-size:17px;background-image:none;background-position:initial initial;background-repeat:initial initial;"><code style="margin:0px;padding:0px;border:none;font-family:Menlo, Monaco, 'Andale Mono', 'lucida console', 'Courier new', monospace;font-size:0.9em;background:none;"><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#586e75 !important;">}</span></span></code> </pre> <p>如果没有开启Core Location 那么上面的didReceiveLocalNotificat<wbr>ion不会被调用</p>
</blockquote>
<p>
最后再总结一下，整个推送流程我觉得是这样子的，先注册推送，然后推送消息，客户端接收推送消息，执行推送行为。如果有错误，还请在文章下面评论，欢迎指正。</p>
<p><img exify_intitialized="true" action-type="show-slide" action-data="http%3A%2F%2Fww2.sinaimg.cn%2Flarge%2F626e5d69gw1ehyg8u1o51j21ea0qkmz1.jpg" src="http://ww2.sinaimg.cn/large/626e5d69gw1ehyg8u1o51j21ea0qkmz1.jpg" real_src="http://ww2.sinaimg.cn/large/626e5d69gw1ehyg8u1o51j21ea0qkmz1.jpg" alt="推送的流程" title="iOS&nbsp;&lt;wbr&gt;8&nbsp;&lt;wbr&gt;体验推送" /></p>
<hr />
</div></body></html>