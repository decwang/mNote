<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2016-12-08T08:12:01Z"/><meta name="updated" content="2016-12-08T08:12:03Z"/><title>高质量的工程代码为什么难写  作者: hellojava  发布时间: 2016-11-30 13:53  阅读: 7551 次  推荐: 17   原文链接   [收藏]    　　之所以想起写这</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><h1 class="contents_header" style="margin:0px auto;padding:10px 0px;width:650px;line-height:50px;text-align:center;border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:#b2b2b2;font-size:20px;color:#232323;font-family:verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><a href="http://kb.cnblogs.com/page/558087/" style="margin:0px;padding:0px;color:#000000;text-decoration:none;">高质量的工程代码为什么难写</a></h1>
<div class="contents_info" style="margin:5px 0px 25px;padding:0px;text-align:center;background-color:transparent;font-size:12px;position:relative;color:#404040;line-height:19.2px;font-family:verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;background-position:initial initial;background-repeat:initial initial;">作者: hellojava&nbsp;&nbsp;发布时间: 2016-11-30 13:53&nbsp;&nbsp;阅读: 7551 次&nbsp;&nbsp;推荐: 17&nbsp;&nbsp;&nbsp;<a id="link_source" href="http://hellojava.info/?p=508" target="_blank" style="margin:0px;padding:0px;color:#1a64a2;text-decoration:none;">原文链接</a>&nbsp;&nbsp;&nbsp;<a class="graylink" style="margin:0px;padding:0px;color:#1a64a2;">[收藏]</a>&nbsp;&nbsp;</div>
<div class="contents_main" style="margin:0px;padding:0px;width:690px;line-height:25.2px;color:#232323;font-family:verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><div id="ArticleCnt" style="margin:0px 10px 0px 15px;padding:0px;line-height:28px;overflow:hidden;"><p style="padding:0px;">　　之所以想起写这篇文章，是因为最近看到的一个著名的开源项目在内部使用时的各种问题，不得不说，很多的开源的东西思想是不错的，但离真正工程化都有不小的距离，所以没什么商业公司采用的开源产品如果要引入的话一定要慎重，通常会有N多的坑等着你去填，而比较成功的开源项目的背后多数都会有商业公司在背后不断的改进。</p>
<p style="padding:0px;">　　遥想我2000年开始学习写asp代码时，觉得写代码也不难呀，无非就是学学语法规则、库就可以写出来，记得有一次我实习面试的时候是让我在一个下午左右的时间写一个完整的留言板，那也就是刷刷刷就写好了，但随着后来工作，尤其是加入阿里以后，越来越明白高质量的工程代码为什么难写。</p>
<p style="padding:0px;">　　在写代码初期，最关注的是如何用代码实现需求，如果是仅仅实现业务需求的话，即使是刚上手的程序员，只要解题能力还OK，基本上都是可以写出代码来的。所以我自己一直认为数学成绩是程序员的一个非常重要的要求，数学好的人通常解题和逻辑思维能力是还不错的。</p>
<p style="padding:0px;">　　上面的这个基本的写代码的过程中，写的更好的同学的体现会在对业务的深刻理解以及抽象上，写出的代码会具备一定的复用能力，这个在这里不多加探讨。</p>
<p style="padding:0px;">　　但代码是不是实现了业务需求就结束了呢，其实远没有，这其实只是写代码的开始，除了正向的逻辑实现外，任何一个点的异常的分支逻辑怎么处理才是工程化的代码中更难处理的部分，这个问题在单机式的系统中会相对还好处理，在分布式的环境会变得非常的复杂，例如调用其他机器的功能超时了，出错了，到底该怎么处理，这也是为什么有了那么多的分布式的理论的东西出来，在增加了异常分支的处理逻辑后，通常会发现这个时候正向逻辑的代码在整个代码的占比中会大幅下降。</p>
<p style="padding:0px;">　　异常分支逻辑处理好后，通常还需要增加必要的日志信息，以便在出问题时方便排查，而不是到了要排查问题的时候，一点目前系统的状况都搞不清楚，所以吃掉重要的异常信息不抛出这种行为在写代码中是非常可耻的。</p>
<p style="padding:0px;">　　在处理好上面异常的相关动作后，代码的健壮性也要处理好，这个主要指：</p>
<p style="padding:0px;">　　<strong style="margin:0px;padding:0px;color:#333333;">1. 自我保护能力</strong></p>
<p style="padding:0px;">　　对外提供的接口是否具备足够的自我保护能力，就是即使使用的人没仔细看API文档随便乱用也不会导致系统出问题，这种案例非常的多，例如对外提供了一个批量查询接口，结果用户一下传了一个里面有上千个用户id的数组，查询一下直接把内存耗光，像这种情况下不能怪使用的人，而应该怪实现API的这一端的保护做的不够好，按照这样的标准去看，会发现开源的很多东西的API都不太合格。</p>
<p style="padding:0px;">　　还有一种就是能力保护，如果超出了处理的并发量的能力，这个时候会发生什么。</p>
<p style="padding:0px;">　　<strong style="margin:0px;padding:0px;color:#333333;">2. 对资源的使用限制</strong></p>
<p style="padding:0px;">　　这也是代码新手或一些开源产品中做的比较差的地方，很容易出现规模一上去，资源使用量也一直涨，没有限制，然后导致系统挂掉，很常见的案例是对线程池的使用，例如像Java中的Executors.newCachedThreadPool，这个接口很多人会用到，但很多用的人都没有仔细想过会不会在某种情况下这里创建出巨多的线程；还有例如用Map做cache，也没考虑大小限制的问题，结果就是随着数据量增长，某天突然就挂了。</p>
<p style="padding:0px;">　　健壮性是代码中比较复杂的部分，通常也是比较展现代码能力的部分，可能看起来就几行代码，但其实背后反映的差距是巨大的。</p>
<p style="padding:0px;">　　开源产品除了在健壮性上的差距外，通常还会出现的一个巨大差距就是整个系统的设计的伸缩能力，伸缩能力不够的话通常会导致结构性的重构，另外常见的就是在并发的处理上不够高效，例如锁的合理使用、无锁算法的引入等等，而这些需要非常强的系统设计和代码功底能力。</p>
<p style="padding:0px;">　　除了上面说的这些外，高质量的工程代码还需要考虑可维护（例如监控信息暴露）、安全性等，对我而言，我一直认为所谓的工程化其实就是把一些玩具性质的代码变成可在商业系统中真正健壮运行的代码。</p>
<p style="padding:0px;">　　上面的内容写的比较简略，不过应该也能看出，对于高质量的工程代码而言，其实实现业务逻辑只是其中占比很小的一部分，甚至花的时间是相对最少的一部分，所以我确实非常赞同面试的时候让同学写代码，这个时候很容易看出同学写代码的功力；有些时候为了考察同学写代码的熟练程度，我会问问IDE的快捷键，或者让手写一段不是太复杂的代码。</p>
</div>
</div></body></html>