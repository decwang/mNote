<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2017-06-04T02:09:16Z"/><meta name="updated" content="2017-06-04T02:10:13Z"/><title>查找所有重复标题的记录</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">查找所有重复标题的记录：</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">SELECT * FROM t_info a WHERE ((SELECT COUNT(*) FROM t_info WHERE Title = a.Title) &gt; 1) ORDER BY Title DESC &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">一、查找重复记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">1、查找全部重复记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">Select * From 表 Where 重复字段 In (Select 重复字段 From 表 Group By 重复字段 Having Count(*)&gt;1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">2、过滤重复记录(只显示一条)</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">Select * From HZT Where ID In (Select Max(ID) From HZT Group By Title) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">注：此处显示ID最大一条记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">二、删除重复记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">1、删除全部重复记录（慎用）</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">Delete 表 Where 重复字段 In (Select 重复字段 From 表 Group By 重复字段 Having Count(*)&gt;1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">2、保留一条（这个应该是大多数人所需要的 ^_^）</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">Delete HZT Where ID Not In (Select Max(ID) From HZT Group By Title) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">注：此处保留ID最大一条记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">三、举例</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">1、查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select * from people where peopleId in (select peopleId from people group by peopleId having count(peopleId) &gt; 1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">2、删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">delete from people where peopleId in (select peopleId from people group by peopleId having count(peopleId) &gt; 1) and rowid not in (select min(rowid) from people group by peopleId having count(peopleId )&gt;1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">3、查找表中多余的重复记录（多个字段）</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select * from vitae a where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by peopleId,seq having count(*) &gt; 1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">4、删除表中多余的重复记录（多个字段），只留有rowid最小的记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">delete from vitae a where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by peopleId,seq having count(*) &gt; 1) and rowid not in (select min(rowid) from vitae group by peopleId,seq having count(*)&gt;1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">5、查找表中多余的重复记录（多个字段），不包含rowid最小的记录</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select * from vitae a where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by peopleId,seq having count(*) &gt; 1) and rowid not in (select min(rowid) from vitae group by peopleId,seq having count(*)&gt;1) &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">四、补充</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">有两个以上的重复记录，一是完全重复的记录，也即所有字段均重复的记录，二是部分关键字段重复的记录，比如Name字段重复，而其他字段不一定重复或都重复可以忽略。</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">1、对于第一种重复，比较容易解决，使用</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select distinct * from tableName &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">就可以得到无重复记录的结果集。</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">如果该表需要删除重复的记录（重复记录保留1条），可以按以下方法删除&nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select distinct * into #Tmp from tableName &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">drop table tableName &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select * into tableName from #Tmp &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">drop table #Tmp &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">发生这种重复的原因是表设计不周产生的，增加唯一索引列即可解决。</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">2、这类重复问题通常要求保留重复记录中的第一条记录，操作方法如下</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">假设有重复的字段为Name,Address，要求得到这两个字段唯一的结果集</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select identity(int,1,1) as autoID, * into #Tmp from tableName &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select min(autoID) as autoID into #Tmp2 from #Tmp group by Name,autoID &nbsp;</p>
<p style="color:#333333;font-family:Arial;font-variant-ligatures:normal;orphans:2;widows:2;">select * from #Tmp where autoID in(select autoID from #tmp2) &nbsp;</p></body></html>