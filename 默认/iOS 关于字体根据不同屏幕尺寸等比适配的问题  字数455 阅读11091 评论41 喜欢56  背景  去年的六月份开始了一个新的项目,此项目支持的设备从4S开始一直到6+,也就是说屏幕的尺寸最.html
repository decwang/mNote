<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2016-11-11T10:07:53Z"/><meta name="updated" content="2016-11-11T10:07:55Z"/><title>iOS 关于字体根据不同屏幕尺寸等比适配的问题  字数455 阅读11091 评论41 喜欢56  背景  去年的六月份开始了一个新的项目,此项目支持的设备从4S开始一直到6+,也就是说屏幕的尺寸最</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><h1 class="title" style="margin:10px 0px;font-family:-apple-system, 'Helvetica Neue', Arial, 'PingFang SC', 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;line-height:1.5;color:#555555;text-rendering:optimizelegibility;font-size:32px;word-break:break-all;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;widows:1;">iOS 关于字体根据不同屏幕尺寸等比适配的问题</h1>
<div class="meta-top" style="font-family:-apple-system, 'Helvetica Neue', Arial, 'PingFang SC', 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;margin:20px 0px;color:#555555;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:20px;widows:1;"><span class="wordage" style="position:relative;top:1px;margin-right:10px;font-size:12px;color:#999999;">字数455</span>&nbsp;<span class="views-count" style="position:relative;top:1px;margin-right:10px;font-size:12px;color:#999999;">阅读11091</span>&nbsp;<span class="comments-count" style="position:relative;top:1px;margin-right:10px;font-size:12px;color:#999999;">评论41</span>&nbsp;<span class="likes-count" style="position:relative;top:1px;margin-right:10px;font-size:12px;color:#999999;">喜欢56</span></div>
<div class="show-content" style="color:#2f2f2f;font-size:16px;line-height:1.7;font-family:-apple-system, 'Helvetica Neue', Arial, 'PingFang SC', 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;widows:1;"><h1 style="margin:0px;font-family:inherit;line-height:1.8;color:inherit;text-rendering:optimizelegibility;font-size:26px;">背景</h1>
<ul style="padding:0px;margin:0px 0px 20px 25px;text-align:justify;word-break:break-word;"><li style="line-height:30px;"><p style="margin-top:16px;margin-bottom:16px;word-break:break-word;overflow:visible;">去年的六月份开始了一个新的项目,此项目支持的设备从4S开始一直到6+,也就是说屏幕的尺寸最小的320x480 最大的1242x2208 （不过目前好像大部分的App都会这样去支持），而客户那边有一个奇葩要求 就是所有的控件布局必须依据屏幕的尺寸等比缩放。当然这个对于iOS的开发来说的话还是比较容易实现的（iOS有个Autoresizing刚好是依据父视图的大小作等比缩放的）。</p>
</li>
<li style="line-height:30px;"><p style="margin-top:16px;margin-bottom:16px;word-break:break-word;overflow:visible;">项目就这样愉快的进行，然而当项目快要结束的时候，客户愤怒质问我们为什么字体大小没有根据屏幕作等比适配，再有几天的时间就要上线了，直到现在才发现这种天天在眼前晃荡的问题。。。。</p>
</li>
<li style="line-height:30px;"><p style="margin-top:16px;margin-bottom:16px;word-break:break-word;overflow:visible;">此时我们开发的内心是崩溃的。。。 因为项目非常赶时间，客户要求17天上线第一个版本，所有跟主流程相关的功能必须实现。当时为了赶时间 加上为了做等比适配，所有视图全部是用XIB拖出来的 字体都是直接设置在视图里面 没有抽出来 现在要是做字体的等比适配的话 这种大量完全没有技术含量的体力活让人很无力</p>
</li>
</ul>
<h1 style="margin:0px;font-family:inherit;line-height:1.8;color:inherit;text-rendering:optimizelegibility;font-size:26px;">解决方法</h1>
<ul style="padding:0px;margin:0px 0px 20px 25px;text-align:justify;word-break:break-word;"><li style="line-height:30px;">新建一个UIButton的类别 重写 load 方法 利用OC的运行时 对所有的Button Label作处理（一般有文字的大部分是 Button Label）<br />
代码如下<br />
UIButton+MyFont.h</li>
</ul>
<pre class="hljs objectivec" style="padding:9.5px;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;font-size:13px;color:#657b83;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:4px;border-bottom-left-radius:4px;margin-top:0px;margin-bottom:20px;line-height:20px;word-break:break-all;word-wrap:normal;border:1px solid rgba(0, 0, 0, 0.14902);overflow:auto;background-color:#fdf6e3;background-position:initial initial;background-repeat:initial initial;"><code class="objectivec" style="padding:0px;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;font-size:12px;border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px;border:none;background-color:transparent;"><span class="hljs-preprocessor" style="color:#cb4b16;">#import <span class="hljs-title" style="color:#268bd2;">&lt;UIKit/UIKit.h&gt;</span></span> <span class="hljs-preprocessor" style="color:#cb4b16;">#import <span class="hljs-title" style="color:#268bd2;">&lt;objc/runtime.h&gt;</span></span> <span class="hljs-comment" style="color:#93a1a1;">/**
 *  按钮
 */</span> <span class="hljs-class"><span class="hljs-keyword" style="color:#859900;">@interface</span> <span class="hljs-title" style="color:#b58900;">UIButton</span> (<span class="hljs-title" style="color:#b58900;">myFont</span>)</span> <span class="hljs-keyword" style="color:#859900;">@end</span> <span class="hljs-comment" style="color:#93a1a1;">/**
 *  Label
 */</span> <span class="hljs-class"><span class="hljs-keyword" style="color:#859900;">@interface</span> <span class="hljs-title" style="color:#b58900;">UILabel</span> (<span class="hljs-title" style="color:#b58900;">myFont</span>)</span> <span class="hljs-keyword" style="color:#859900;">@end</span></code></pre><p style="margin-top:0px;margin-bottom:25px;text-align:justify;word-break:break-word;">UIButton+MyFont.m</p>
<pre class="hljs objectivec" style="padding:9.5px;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;font-size:13px;color:#657b83;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:4px;border-bottom-left-radius:4px;margin-top:0px;margin-bottom:20px;line-height:20px;word-break:break-all;word-wrap:normal;border:1px solid rgba(0, 0, 0, 0.14902);overflow:auto;background-color:#fdf6e3;background-position:initial initial;background-repeat:initial initial;"><code class="objectivec" style="padding:0px;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;font-size:12px;border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px;border:none;background-color:transparent;"><span class="hljs-preprocessor" style="color:#cb4b16;">#import <span class="hljs-title" style="color:#268bd2;">"UIButton+MyFont.h"</span></span> <span class="hljs-comment" style="color:#93a1a1;">//不同设备的屏幕比例(当然倍数可以自己控制)</span> <span class="hljs-preprocessor" style="color:#cb4b16;">#define SizeScale ((IPHONE_HEIGHT &gt; 568) ? IPHONE_HEIGHT/568 : 1)</span> <span class="hljs-class"><span class="hljs-keyword" style="color:#859900;">@implementation</span> <span class="hljs-title" style="color:#b58900;">UIButton</span> (<span class="hljs-title" style="color:#b58900;">myFont</span>)</span> + (<span class="hljs-keyword" style="color:#859900;">void</span>)load{
    Method imp = class_getInstanceMethod([<span class="hljs-keyword" style="color:#859900;">self</span> class], <span class="hljs-keyword" style="color:#859900;">@selector</span>(initWithCoder:));
    Method myImp = class_getInstanceMethod([<span class="hljs-keyword" style="color:#859900;">self</span> class], <span class="hljs-keyword" style="color:#859900;">@selector</span>(myInitWithCoder:));
    method_exchangeImplementations(imp, myImp);
}

- (<span class="hljs-keyword" style="color:#859900;">id</span>)myInitWithCoder:(<span class="hljs-built_in" style="color:#268bd2;">NSCoder</span>*)aDecode{
    [<span class="hljs-keyword" style="color:#859900;">self</span> myInitWithCoder:aDecode];
    <span class="hljs-keyword" style="color:#859900;">if</span> (<span class="hljs-keyword" style="color:#859900;">self</span>) {
        <span class="hljs-comment" style="color:#93a1a1;">//部分不像改变字体的 把tag值设置成333跳过</span>         <span class="hljs-keyword" style="color:#859900;">if</span>(<span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.titleLabel</span><span class="hljs-variable" style="color:#b58900;">.tag</span> != <span class="hljs-number" style="color:#2aa198;">333</span>){
            <span class="hljs-built_in" style="color:#268bd2;">CGFloat</span> fontSize = <span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.titleLabel</span><span class="hljs-variable" style="color:#b58900;">.font</span><span class="hljs-variable" style="color:#b58900;">.pointSize</span>;
            <span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.titleLabel</span><span class="hljs-variable" style="color:#b58900;">.font</span> = [<span class="hljs-built_in" style="color:#268bd2;">UIFont</span> systemFontOfSize:fontSize*SizeScale];
        }
    }
    <span class="hljs-keyword" style="color:#859900;">return</span> <span class="hljs-keyword" style="color:#859900;">self</span>;
}<span class="hljs-keyword" style="color:#859900;">@end</span> <span class="hljs-class"><span class="hljs-keyword" style="color:#859900;">@implementation</span> <span class="hljs-title" style="color:#b58900;">UILabel</span> (<span class="hljs-title" style="color:#b58900;">myFont</span>)</span> + (<span class="hljs-keyword" style="color:#859900;">void</span>)load{
    Method imp = class_getInstanceMethod([<span class="hljs-keyword" style="color:#859900;">self</span> class], <span class="hljs-keyword" style="color:#859900;">@selector</span>(initWithCoder:));
    Method myImp = class_getInstanceMethod([<span class="hljs-keyword" style="color:#859900;">self</span> class], <span class="hljs-keyword" style="color:#859900;">@selector</span>(myInitWithCoder:));
    method_exchangeImplementations(imp, myImp);
}

- (<span class="hljs-keyword" style="color:#859900;">id</span>)myInitWithCoder:(<span class="hljs-built_in" style="color:#268bd2;">NSCoder</span>*)aDecode{
    [<span class="hljs-keyword" style="color:#859900;">self</span> myInitWithCoder:aDecode];
    <span class="hljs-keyword" style="color:#859900;">if</span> (<span class="hljs-keyword" style="color:#859900;">self</span>) {
        <span class="hljs-comment" style="color:#93a1a1;">//部分不像改变字体的 把tag值设置成333跳过</span>         <span class="hljs-keyword" style="color:#859900;">if</span>(<span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.tag</span> != <span class="hljs-number" style="color:#2aa198;">333</span>){
            <span class="hljs-built_in" style="color:#268bd2;">CGFloat</span> fontSize = <span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.font</span><span class="hljs-variable" style="color:#b58900;">.pointSize</span>;
            <span class="hljs-keyword" style="color:#859900;">self</span><span class="hljs-variable" style="color:#b58900;">.font</span> = [<span class="hljs-built_in" style="color:#268bd2;">UIFont</span> systemFontOfSize:fontSize*SizeScale];
        }
    }
    <span class="hljs-keyword" style="color:#859900;">return</span> <span class="hljs-keyword" style="color:#859900;">self</span>;
}<span class="hljs-keyword" style="color:#859900;">@end</span></code></pre><p style="margin-top:0px;margin-bottom:25px;text-align:justify;word-break:break-word;">实在不好意思，前段时间有点忙 附上demo地址<br />
<a href="https://github.com/ywdonga/FontSizeModify" target="_blank" style="color:#4094c7;text-decoration:none;">https://github.com/ywdonga/FontSizeModify</a></p>
</div></body></html>