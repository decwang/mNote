<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2016-10-18T06:15:30Z"/><meta name="updated" content="2016-10-18T06:15:32Z"/><title>在ios平台上做网络开发最常用的两个类：       NSMutableURLRequest  *urlRequest = [[ NSMutableURLRequestalloc ] initWit</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="color:#ffffff;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:19.5px;widows:1;padding:0px;margin:0px;background-color:#333333;"><span size="2" style="font-size:14px;">在ios平台上做网络开发最常用的两个类：</span></div>
<div style="color:#ffffff;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:19.5px;widows:1;padding:0px;margin:0px;background-color:#333333;"><p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;color:#7041a7;padding:0px;"><span color="#3d227f" style="color:#3d227f;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;color:#7041a7;padding:0px;"></p>
<div class="cnblogs_Highlighter"><div id="highlighter_296948" class="syntaxhighlighter nogutter objc" style="width:613px;margin:1em 0px !important;position:relative !important;overflow:auto !important;font-size:1em !important;background-color:#ffffff !important;"><table border="0" cellpadding="0" cellspacing="0" style="border:1px solid silver;width:613px;word-break:break-word;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.1em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;font-size:12px !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><tbody style="border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.1em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><tr style="border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.1em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><td class="code" style="border:1px solid silver;padding:3px;border-collapse:collapse;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.1em !important;margin:0px !important;outline:0px !important;overflow:visible !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><div class="container" style="border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.1em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:relative !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><div class="line number1 index0 alt2" style="border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px 1em 0px 0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;background-image:none !important;background-color:#f4f4f4 !important;background-position:initial initial !important;background-repeat:initial initial !important;"><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">NSMutableURLRequest</code>&nbsp;<code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">*urlRequest = [[</code><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">NSMutableURLRequestalloc</code><code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">] initWithURL:url cachePolicy:</code><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">NSURLRequestUseProtocolCachePolicytimeoutInterval</code><code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">:10];&nbsp; </code></div>
<div class="line number2 index1 alt1" style="border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px 1em 0px 0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;"><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">NSURLConnection</code>&nbsp;<code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">*_connection = [[</code><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">NSURLConnectionalloc</code><code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">] initWithRequest:urlRequest delegate:selfstartImmediately:</code><code class="objc keyword" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:#0000ff !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">YES</code><code class="objc plain" style="white-space:pre-wrap;border-top-left-radius:0px !important;border-top-right-radius:0px !important;border-bottom-right-radius:0px !important;border-bottom-left-radius:0px !important;border:0px !important;bottom:auto !important;float:none !important;height:auto !important;left:auto !important;line-height:1.8em !important;margin:0px !important;outline:0px !important;overflow:visible !important;padding:0px !important;position:static !important;right:auto !important;top:auto !important;vertical-align:baseline !important;width:auto !important;box-sizing:content-box !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-image:none !important;background-position:initial initial !important;background-repeat:initial initial !important;">];</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div style="color:#ffffff;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:19.5px;widows:1;padding:0px;margin:0px;background-color:#333333;"><p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span class="Apple-style-span" style="color:#7041a7;">&nbsp;</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp;一个用来创建请求，一个用来将请求发送出去。然后我们实现&nbsp;NSUrlConnectionDelegate 的几个回调函数就能完成整个流程了。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp;一般发送网络请求都会去设置一个超时时间，防止请求在那一直等待。根据不同的场景，我们还需要设置不同的超时时间。在上面的代码中我们设置了10秒超时。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span class="Apple-style-span" style="line-height:normal;font-size:14px;">&nbsp; &nbsp;上面的故事看起来很完美。但是 apple的开发人员在这里给我们挖了一个坑。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">如果你的请求是个简单的“Get”请求，或者木有 body的“post”请求。一切都是那么完美，请求能够按照我们设定的时间自动超时。但是如果你发的是个“POST”请求，并且[urlRequest setHTTPBody:httpBody]; 那么，不好意思，你被潜规则了。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp;ios3.0 以后 苹果的sdk对这种情况做了调整，如果是post请求，并且设置了 httpBody，那么请求的超时时间就被默认设置为 240 秒了。就算你再使用[urlRequest&nbsp;setTimeoutInterval:10];也是无效的，我们可以再设置完成后再读取这个值，发现它不会变成10，依然保持240秒。于是乎，网络不稳定的时候，你的程序就可能会陷入漫长的等待。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span class="Apple-style-span" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp;发现这个问题后。我们通过自己起timer的方式来控制超时。具体怎么弄这里就不细说。只说下我们的策略。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">我们将整个网络过程分为 &nbsp;链接建立，发送数据，数据发送完成等待回包，接收数据 4个阶段来控制具体的超时。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">设置我们的标准超时时间为 N （系统默认为 10秒，网络模块通过暴露相关接口，调用方可自由设置）</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp; 链接建立链接超时时间： &nbsp; &nbsp;N * 1.5</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp; 每数据包发送超时时间： &nbsp; &nbsp;N * 1.5</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp; 数据发送完成等带回包超时： N * 2</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">&nbsp; &nbsp; 每数据包接收超时时间： &nbsp; &nbsp;N * 1</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">以上超时分别在&nbsp;NSUrlConnectionDelegate 的各个回调阶段进行相关设置就能达到比较精细的控制。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">特别说明下，为什么数据发送完成后等待回包的超时会设置的比较长。因为在实际测试过程中发现发包完成到接收到第一个数据包比较耗时，一般httpbody越大越明显，初步猜测是网络模块在发送数据缓冲区的数据，所以这里做了特殊的控制。</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;line-height:normal;font-size:11px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-family:Menlo;padding:0px;"><span size="2" style="font-size:14px;">哦了。罗嗦了半天，终于说完了。希望能对大家有帮助。能跳过这个坑。</span></p>
</div></body></html>