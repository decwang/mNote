<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2017-02-14T05:40:40Z"/><meta name="updated" content="2017-02-14T05:40:45Z"/><title> iOS后台持续定位并定时上传    标签： iOS定位持续定位后台定位  2015-04-15 21:05 6305人阅读 评论(3) 收藏 举报     分类：  iOS（59）     版权声</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div class="article_title" style="margin:5px 0px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:20px;line-height:30px;font-family:'Microsoft YaHei';orphans:2;widows:2;">&nbsp;<h1 style="margin:0px;padding:0px;display:inline;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-weight:normal;font-size:20px;line-height:30px;vertical-align:middle;"><span class="link_title"><a href="http://blog.csdn.net/dolacmeng/article/details/45064939" style="color:#000000;text-decoration:none;">iOS后台持续定位并定时上传</a></span></h1>
</div>
<div class="article_manage clearfix" style="padding:0px 20px 5px;color:#999999;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:12px;line-height:22px;font-family:Arial;text-align:right;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#ededed;margin:0px -20px;overflow:hidden;orphans:2;widows:2;"><div class="article_l" style="width:946px;float:left;"><span class="link_categories" style="margin:0px 5px;float:left;">标签：&nbsp;<a href="http://www.csdn.net/tag/iOS%e5%ae%9a%e4%bd%8d" target="_blank" style="color:#ca0000;text-decoration:none;display:inline-block;margin-right:10px;">iOS定位</a><a href="http://www.csdn.net/tag/%e6%8c%81%e7%bb%ad%e5%ae%9a%e4%bd%8d" target="_blank" style="color:#ca0000;text-decoration:none;display:inline-block;margin-right:10px;">持续定位</a><a href="http://www.csdn.net/tag/%e5%90%8e%e5%8f%b0%e5%ae%9a%e4%bd%8d" target="_blank" style="color:#ca0000;text-decoration:none;display:inline-block;margin-right:10px;">后台定位</a></span></div>
<div class="article_r"><span class="link_postdate" style="margin:0px 5px 0px 0px;">2015-04-15 21:05</span>&nbsp;<span class="link_view" title="阅读次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;../../../images/ico_view.png&quot;) left center no-repeat;">6305人阅读</span>&nbsp;<span class="link_comments" title="评论次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;../../../images/ico_comm.png&quot;) left center no-repeat;"><a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#comments" style="color:#ca0000;text-decoration:none;">评论</a>(3)</span>&nbsp;<span class="link_collect tracking-ad" data-mod="popu_171" style="margin:0px 5px;"><a title="收藏" target="_blank" style="color:#ca0000;">收藏</a></span>&nbsp;<span class="link_report" style="margin:0px 5px;"><a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#report" title="举报" style="color:#ca0000;text-decoration:none;">举报</a></span></div>
</div>
<div class="category clearfix" style="margin:0px -20px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#ededed;padding:5px 20px;font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;font-variant-ligatures:normal;orphans:2;widows:2;"><div class="category_l" style="display:inline-block;font-size:14px;color:#333333;width:70px;float:left;line-height:28px;"><img src="http://static.blog.csdn.net/images/category_icon.jpg" style="border:none;vertical-align:middle;" />&nbsp;<span style="display:inline-block;vertical-align:middle;">分类：</span></div>
<div class="category_r" style="display:inline-block;font-size:14px;color:#df3434;float:left;width:851.391px;"><label style="display:inline-block;margin-left:15px;cursor:pointer;line-height:28px;position:relative;">iOS（59）&nbsp;<img class="arrow-down" src="http://static.blog.csdn.net/images/arrow_triangle%20_down.jpg" style="border:none;display:inline;" /></label></div>
</div>
<div class="bog_copyright" style="padding:20px 0px;font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;font-variant-ligatures:normal;orphans:2;widows:2;"><p class="copyright_p" style="margin-top:0px;margin-bottom:0px;padding:0px 0px 0px 10px;height:14px;line-height:14px;border-left-width:3px;border-left-style:solid;border-left-color:#e41c1e;color:#666666;font-size:14px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<div style="font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;font-variant-ligatures:normal;orphans:2;widows:2;clear:both;"></div>
<div style="font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;font-variant-ligatures:normal;orphans:2;widows:2;border:1px solid #cccccc;background-color:#eeeeee;float:left;min-width:200px;padding:4px 10px;background-position:initial initial;background-repeat:initial initial;"><p style="margin-top:0px;margin-bottom:0px;padding:0px;text-align:right;"><span style="float:left;">目录<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" title="系统根据文章中H1到H6标签自动生成文章目录" style="color:#ca0000;text-decoration:none;">(?)</a></span><a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" title="展开" style="color:#ca0000;text-decoration:none;">[+]</a></p>
</div>
<div style="font-family:Arial, Console, Verdana, 'Courier New';font-size:12px;font-variant-ligatures:normal;orphans:2;widows:2;clear:both;"></div>
<div id="article_content" class="article_content" style="margin:20px 0px 0px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:26px;font-family:Arial;orphans:2;widows:2;"><p style="margin-top:0px;margin-bottom:0px;padding:0px;">最近做一个考勤APP，功能很简单，就是一直在后台运行，每隔固定时间向服务器上传一次位置信息。持续运行24小时测试，功能实现。</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<h4 style="margin:0px;padding:0px;"><a name="t0" style="color:#ca0000;"></a>1.<span style="font-family:Menlo;font-size:18px;">ViewController</span>.h文件：</h4>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><span style="font-family:SimSun;">#import &lt;CoreLocation/CoreLocation.h&gt;并</span>实现CLLocationManagerDelegate 代理，.h文件完整代码如下：</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:697px;top:650px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_1" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=18&amp;height=18" wmode="transparent" /></div>
</span></div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#import&nbsp;&lt;UIKit/UIKit.h&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#import&nbsp;&lt;CoreLocation/CoreLocation.h&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@interface</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;ViewController&nbsp;:&nbsp;UIViewController&lt;CLLocationManagerDelegate&gt;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@end</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<br />
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<h4 style="margin:0px;padding:0px;"><a name="t1" style="color:#ca0000;"></a><span style="font-size:18px;">2.</span><span style="font-size:18px;">info.list文件:</span><br />
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><span style="font-family:SimSun;font-weight:normal;">右键，Add Row,添加的Key为NSLocationAlwaysUsageDescription，其它值默认，示例如下：</span></p>
</h4>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><img src="http://img.blog.csdn.net/20150415211329838?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZG9sYWNtZW5n/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none;" /></p>
<h4 style="margin:0px;padding:0px;"><a name="t2" style="color:#ca0000;"></a><span style="font-size:18px;"><br />
3.添加后台定位权限</span></h4>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><img src="http://img.blog.csdn.net/20150416130811781?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZG9sYWNtZW5n/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none;" /></p>
<h4 style="margin:0px;padding:0px;"><a name="t3" style="color:#ca0000;"></a><span style="font-size:18px;">4.ViewController.m 文件：</span></h4>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">(1)定义一个私有CLLocationManager对象</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">(2)初始化并设置参数（initLocation方法），其中</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">locationManager.desiredAccuracy<span style="font-family:&quot;Heiti SC Light&quot;;">设置定位精度，有六个值可选，精度依次递减</span></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyBestForNavigation&nbsp;</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyBest</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyNearestTenMeters</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyHundredMeters</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyKilometer</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">kCLLocationAccuracyThreeKilometers</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">locationManager.pausesLocationUpdatesAutomatically&nbsp;设置是否允许系统自动暂停定位，<strong><span style="color:#ff0000;">这里要设置为NO，刚开始我没有设置，后台定位持续20分钟左右就停止了！</span></strong></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><span style="font-family:&quot;Heiti SC Light&quot;;"><br />
</span></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">(3)实现CLLocationManagerDelegate的代理方法，此方法在每次定位成功后调用：</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">-(void)locationManager:(CLLocationManager&nbsp;*)manager didUpdateLocations:(NSArray*)locations;</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;">*也可以通过实现以下方法：</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">- (void)locationManager:(CLLocationManager *)manager</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">didUpdateToLocation:(CLLocation *)newLocation</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">&nbsp; fromLocation:(CLLocation *)oldLocation</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">(4)实现CLLocationManagerDelegate的代理方法，此方法在定位出错后调用：</p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;"></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-family:Menlo;">-(void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error</p>
<div style="font-size:18px;"><br />
</div>
<div><span style="font-family:Menlo;font-size:18px;color:#6122ae;">.m文件完整代码如下：</span></div>
<div><div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:697px;top:2349px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_2" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_2" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=18&amp;height=18" wmode="transparent" /></div>
</span></div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#import&nbsp;"ViewController.h"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@interface</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;ViewController&nbsp;(){&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocationManager</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*locationManager;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*newLocation;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;CLLocationCoordinate<span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">2</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">D&nbsp;coordinate;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@end</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@implementation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;ViewController&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-&nbsp;(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)viewDidLoad&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">super</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;viewDidLoad</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;initLocation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#pragma&nbsp;mark&nbsp;初始化定位</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)initLocation&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;locationManager=[[CLLocationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;alloc</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;init</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;locationManager<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.delegate</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;locationManager<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.desiredAccuracy</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;kCLLocationAccuracyBest;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//设置定位精度</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">([[[UIDevice</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;currentDevice</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;systemVersion</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;floatValue</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]&nbsp;&gt;=&nbsp;</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">8</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">){&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;requestWhenInUseAuthorization</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(![CLLocationManager</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;locationServicesEnabled</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">]){&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSLog(<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"请开启定位:设置&nbsp;&gt;&nbsp;隐私&nbsp;&gt;&nbsp;位置&nbsp;&gt;&nbsp;定位服务"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">([locationManager</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;respondsToSelector</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@selector</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(requestAlwaysAuthorization)])&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;requestAlwaysAuthorization</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;永久授权</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;requestWhenInUseAuthorization</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//使用中授权</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;locationManager<span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.pausesLocationUpdatesAutomatically</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NO</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;startUpdatingLocation</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//[locationManager&nbsp;startMonitoringSignificantLocationChanges];</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#pragma&nbsp;mark&nbsp;定位成功</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)locationManager:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocationManager</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)manager</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;didUpdateLocations</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)locations{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;newLocation&nbsp;=&nbsp;[locations<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;lastObject</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">double</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;lat&nbsp;=&nbsp;newLocation</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.coordinate</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.latitude</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">double</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;lon&nbsp;=&nbsp;newLocation</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.coordinate</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.longitude</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;NSLog(<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"lat:%f,lon:%f"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,lat,lon);&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="xcodepreprocessor" style="margin:0px;padding:0px;border:none;background-color:inherit;">#pragma&nbsp;mark&nbsp;定位失败</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)locationManager:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocationManager</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)manager</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;didFailWithError</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSError</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)error{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;NSLog(<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"error:%@"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,error);&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-&nbsp;(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)didReceiveMemoryWarning&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">super</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;didReceiveMemoryWarning</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;Dispose&nbsp;of&nbsp;any&nbsp;resources&nbsp;that&nbsp;can&nbsp;be&nbsp;recreated.</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">@end</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<div><br />
</div>
<h5><span style="font-family:Menlo;font-size:14px;color:#ff0000;">**经过充电状态下以及非充电状态下测试各24小时，APP运行正常，下图为考勤记录截图，另外测试时，每次定位成功都将日志保存到本地plist文件中中，方法链接：http://blog.csdn.net/dolacmeng/article/details/44805953</span></h5>
</div>
<div><span style="font-family:Menlo;color:#ff0000;"><img src="http://img.blog.csdn.net/20150415214345931?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZG9sYWNtZW5n/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none;" /><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><br />
</span></div>
<div><span style="font-family:Menlo;">（5）以上方法虽然可以让APP在后台运行，但是定位是一直在运行着，难免产生耗电量大的问题，从iOS6开始，Apple提供了方法<span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">&nbsp;</span><code style="font-family:Courier, Consolas, monospace;"><a target="_blank" href="https://developer.apple.com/library/prerelease/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/index.html#//apple_ref/occ/instm/CLLocationManager/allowDeferredLocationUpdatesUntilTraveled:timeout:" style="color:#ca0000;text-decoration:none;">allowDeferredLocationUpdatesUntilTraveled:timeout:</a></code><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">&nbsp;，可以设置在用户移动多远距离或者经过多少时间间隔后才进行一次定位，从而达到省电的目的。</span></span></div>
<div><span style="font-family:Menlo;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;"><br />
</span></span></div>
<div><span style="font-family:Menlo;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">官方说明文档</span><span style="color:#ff0000;font-size:16px;font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">：</span></span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;font-size:16px;"><img src="http://img.blog.csdn.net/20150424171809659" alt="" style="border:none;" /><br />
</span></span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;font-size:16px;"><br />
</span></span></div>
<div><span style="font-family:Menlo;color:#ff0000;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;font-size:16px;"><br />
</span></span></div>
<div><span style="font-family:Menlo;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">官方示例代码：</span></span></div>
<div><div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:697px;top:5827px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_3" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_3" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=3&amp;width=18&amp;height=18" wmode="transparent" /></div>
</span></div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;Delegate&nbsp;method&nbsp;from&nbsp;the&nbsp;CLLocationManagerDelegate&nbsp;protocol.</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">-&nbsp;(<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)locationManager:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocationManager</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)manager&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;didUpdateLocations</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)locations&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;Add&nbsp;the&nbsp;new&nbsp;locations&nbsp;to&nbsp;the&nbsp;hike</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.hike</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;addLocations</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:locations];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;Defer&nbsp;updates&nbsp;until&nbsp;the&nbsp;user&nbsp;hikes&nbsp;a&nbsp;certain&nbsp;distance</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//&nbsp;or&nbsp;when&nbsp;a&nbsp;certain&nbsp;amount&nbsp;of&nbsp;time&nbsp;has&nbsp;passed.</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(!</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.deferringUpdates</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLLocationDistance&nbsp;distance&nbsp;=&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.hike</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.goal</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;-&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.hike</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.distance</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTimeInterval&nbsp;time&nbsp;=&nbsp;[<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.nextAudible</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;timeIntervalSinceNow</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;allowDeferredLocationUpdatesUntilTraveled</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:distance&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;timeout</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:time];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.deferringUpdates</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">YES</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
</ol>
</div>
<br />
<p style="margin-top:0px;margin-bottom:0px;padding:0px;"><span style="font-size:18px;"><span style="font-family:Menlo;"><span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Helvetica, Arial, Verdana, sans-serif;">因此我们把</span></span><span style="font-family:Menlo;">didUpdateLocations方法改成这样（</span></span><span style="font-family:Menlo;font-size:18px;">deferringUpdates</span><span style="font-size:18px;"><span style="font-family:Menlo;">是BOOl类型全局变量，标记是否是</span></span><span style="font-family:Menlo;font-size:18px;">Defer）：</span></p>
<p style="margin-top:0px;margin-bottom:0px;padding:0px;font-size:18px;font-family:Menlo;color:#539aa4;"><span style="background-color:#f0f0f0;color:#ff0000;">#pragma mark 定位成功</span></p>
</div>
<div><div class="dp-highlighter bg_objc" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[objc]</b>&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/dolacmeng/article/details/45064939/#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:697px;top:6288px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_4" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_4" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=4&amp;width=18&amp;height=18" wmode="transparent" /></div>
</span></div>
</div>
<ol start="1" class="dp-objc" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">-(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)locationManager:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">CLLocationManager</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)manager</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;didUpdateLocations</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">NSArray</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;*)locations{&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;newLocation&nbsp;=&nbsp;[locations<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;lastObject</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">double</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;lat&nbsp;=&nbsp;newLocation</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.coordinate</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.latitude</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">double</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;lon&nbsp;=&nbsp;newLocation</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.coordinate</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.longitude</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;NSLog(<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">@"lat:%f,lon:%f"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,lat,lon);&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(!</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.deferringUpdates</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)&nbsp;{&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLLocationDistance&nbsp;distance&nbsp;=&nbsp;<span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">5</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTimeInterval&nbsp;time&nbsp;=&nbsp;<span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">2</span><span class="xcodenumber" style="margin:0px;padding:0px;border:none;background-color:inherit;">0</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[locationManager<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;allowDeferredLocationUpdatesUntilTraveled</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:distance&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#dd0000;background-color:inherit;">&nbsp;timeout</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:time];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">self</span><span class="xcodeconstants" style="margin:0px;padding:0px;border:none;background-color:inherit;">.deferringUpdates</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">YES</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">}&nbsp;&nbsp;</span></li>
</ol>
</div>
<br />
<br />
</div>
<div>但是经过测试，还是没有达到延时的效果，经过查看官方文档和Google后，可能的原因有1.需要使用iphone5及以上的硬件设备（模拟器不得行）2.有其它APP也在请求定位信息，先把他们结束掉。。。。等等等，可以看看这篇论坛讨论：https://devforums.apple.com/message/766429#766429</div>
</div></body></html>