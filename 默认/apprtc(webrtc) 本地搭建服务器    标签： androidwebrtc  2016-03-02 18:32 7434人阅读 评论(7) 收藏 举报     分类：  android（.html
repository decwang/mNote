<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2017-02-27T06:13:04Z"/><meta name="updated" content="2017-02-27T06:13:06Z"/><title>apprtc(webrtc) 本地搭建服务器    标签： androidwebrtc  2016-03-02 18:32 7434人阅读 评论(7) 收藏 举报     分类：  android（</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div class="article_title" style="margin:5px 0px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:20px;line-height:30px;font-family:'Microsoft YaHei';"><h1 style="margin:0px;padding:0px;display:inline;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-weight:normal;font-size:20px;line-height:30px;vertical-align:middle;"><span class="link_title"><a href="http://blog.csdn.net/s569646547/article/details/50780682" style="color:#000000;text-decoration:none;">apprtc(webrtc) 本地搭建服务器</a></span></h1>
</div>
<div class="article_manage clearfix" style="padding:0px 20px 5px;color:#999999;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:12px;line-height:22px;font-family:Arial;text-align:right;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#ededed;margin:0px -20px;overflow:hidden;"><div class="article_l" style="width:708px;float:left;"><span class="link_categories" style="margin:0px 5px;float:left;">标签：&nbsp;<a href="http://www.csdn.net/tag/android" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;margin-right:10px;">android</a><a href="http://www.csdn.net/tag/webrtc" target="_blank" style="color:#336699;text-decoration:none;display:inline-block;margin-right:10px;">webrtc</a></span></div>
<div class="article_r"><span class="link_postdate" style="margin:0px 5px 0px 0px;">2016-03-02 18:32</span>&nbsp;<span class="link_view" title="阅读次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;../../../images/ico_view.png&quot;) left center no-repeat;">7434人阅读</span>&nbsp;<span class="link_comments" title="评论次数" style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;../../../images/ico_comm.png&quot;) left center no-repeat;"><a href="http://blog.csdn.net/s569646547/article/details/50780682#comments" style="color:#336699;text-decoration:none;">评论</a>(7)</span>&nbsp;<span class="link_collect tracking-ad" data-mod="popu_171" style="margin:0px 5px;"><a title="收藏" target="_blank" style="color:#336699;">收藏</a></span>&nbsp;<span class="link_report" style="margin:0px 5px;"><a href="http://blog.csdn.net/s569646547/article/details/50780682#report" title="举报" style="color:#336699;text-decoration:none;">举报</a></span></div>
</div>
<div class="category clearfix" style="margin:0px -20px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#ededed;padding:5px 20px;"><div class="category_l" style="display:inline-block;color:#333333;width:70px;float:left;line-height:28px;"><img src="http://static.blog.csdn.net/images/category_icon.jpg" style="border:none;vertical-align:middle;" />&nbsp;<span style="display:inline-block;vertical-align:middle;">分类：</span></div>
<div class="category_r" style="display:inline-block;color:#df3434;float:left;width:637.188px;"><label style="display:inline-block;margin-left:15px;cursor:pointer;line-height:28px;position:relative;">android（14）&nbsp;<img class="arrow-down" src="http://static.blog.csdn.net/images/arrow_triangle%20_down.jpg" style="border:none;display:inline;" /></label></div>
</div>
<div class="bog_copyright" style="padding:20px 0px;"><p class="copyright_p" style="height:14px;line-height:14px;border-left-width:3px;border-left-style:solid;border-left-color:#e41c1e;padding-left:10px;color:#666666;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<div id="article_content" class="article_content" style="margin:20px 0px 0px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;line-height:26px;font-family:Arial;"><p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">这两天测试了下webrtc的效果，不知道是不是手机比较渣，画面并不是很清晰，先来说说服务器的部署。部署环境ubuntu14.04 32位。<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">一、服务器组成</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、AppRTC 房间服务器&nbsp;&nbsp;<a target="_blank" href="https://github.com/webrtc/apprtc" style="color:#336699;text-decoration:none;">https://github.com/webrtc/apprtc</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、Collider&nbsp; 信令服务器&nbsp; 上边源码里自带</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3、coTurn&nbsp;&nbsp; 穿透服务器&nbsp;&nbsp;&nbsp;<a target="_blank" href="https://github.com/coturn/coturn" style="color:#336699;text-decoration:none;">https://github.com/coturn/coturn</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4、需要自己实现coTurn连接信息接口，主要返回用户名、密码和turn配置信息，通常叫做TURN REST API,不实现这个接口的话AppRTCDemo连不上服务器，浏览器访问的话可以正常访问。</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">二、AppRTC房间服务器</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、下载代码</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、安装依赖</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo apt-get install nodejs</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo npm install -g npm</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo apt-get install nodejs-legacy</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo npm -g install grunt-cli</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 切换到源码目录</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cd apprtc-master</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; npm install</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo apt-get install&nbsp;<a href="http://lib.csdn.net/base/11" class="replace_word" title="undefined" target="_blank" style="color:#df3434;text-decoration:none;font-weight:bold;">Python</a>-webtest</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grunt build</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 编译之后会多出out目录</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 运行还依赖 Google App Engine SDK for&nbsp; Python&nbsp;<a target="_blank" href="https://cloud.google.com/appengine/downloads#Google_App_Engine_SDK_for_Python" style="color:#336699;text-decoration:none;">需翻墙<br />
</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下载完后设置环境变量&nbsp;<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo gedit /etc/profile<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; export PATH=$PATH:/home/google_appengine</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source /etc/profile<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3、修改配置文件</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 主要是src/app_engine目录下的apprtc.py和constants.py</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先是constants.py：</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改TURN_BASE_URL = 'http://192.168.214.129:80'&nbsp; 这个是上边提到的连接信息接口的地址</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TURN_URL_TEMPLATE = '%s/turn.php?username=%s&amp;key=%s'</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CEOD_KEY = 和coturn turnserver.conf&nbsp;static-auth-secret一致<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSS_INSTANCES = [{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; WSS_INSTANCE_HOST_KEY: '192.168.214.129:8089',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSS_INSTANCE_NAME_KEY: 'wsserver-std',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSS_INSTANCE_ZONE_KEY: 'us-central1-a'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }, {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSS_INSTANCE_HOST_KEY: '192.168.214.129:8089',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; WSS_INSTANCE_NAME_KEY: 'wsserver-std-2',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSS_INSTANCE_ZONE_KEY: 'us-central1-f'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }]</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apprtc.py:</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改get_wss_parameters(request) 下的</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if wss_tls and wss_tls == 'false':<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wss_url = 'ws://' + wss_host_port_pair + '/ws'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wss_post_url = 'http://' + wss_host_port_pair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wss_url = 'ws://' + wss_host_port_pair + '/ws'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wss_post_url = 'http://' + wss_host_port_pair</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 主要是把原来的wss和https的scheme都改为ws和http，不要让客户端和浏览器去使用ssl连接，如果有第三&nbsp;&nbsp; 方根证书的签名机构颁发的证书就不需要这样了。</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改完后重新grunt build下。</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4、启动</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dev_appserver.py --host=0.0.0.0 ./out/app_engine</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">三、Collider信令服务器</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、安装依赖</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo apt-get install golang-go</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、在home目下创建文件夹</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mkdir -p ~/collider_root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 并在collider_root目录下创建src目录</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 设置GOPATH环境变量&nbsp;&nbsp;&nbsp; export GOPATH=~/collider_root</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将apprtc/src/collider目录下的三个文件夹都拷贝到collider_root/src下</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入到collider_root/src,开始编译安装collider，准备好翻墙</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; go get collidermain</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; go install collidermain</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 成功编译后会在collider_root目录下生成bin和pkg目录，执行文件在bin下。</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3、运行</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改collider_root/src/collidermain/main.go填上自己ip地址</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var roomSrv = flag.String("room-server", "http://192.168.214.129:8080/", "The origin of the room server")</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 启动</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ~/collider_root/bin/collidermain -port=8089 -tls=false</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">四、coTurn 打洞服务器</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、下载<a target="_blank" href="http://turnserver.open-sys.org/downloads/" style="color:#336699;text-decoration:none;">http://turnserver.open-sys.org/downloads/</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 找个适合自己linux系统的，我这里是ubuntu32位所以选了turnserver-4.2.1.2-debian-wheezy-ubuntu-mint-x86-32bits.tar.gz</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下载完后解压进入解压目录</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cat INSTALL&nbsp;&nbsp;&nbsp;&nbsp; 查看安装须知</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo apt-get install gdebi-core</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo gdebi coturn_4.2.2.2-1_i386.deb</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、编辑配置文件</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sudo gedit /etc/turnserver.conf</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listening-device=eth0</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listening-port=3478<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relay-device=eth1</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; min-port=49152<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max-port=65535<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Verbose</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fingerprint</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lt-cred-mech</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use-auth-secret</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static-auth-secret=填写自己的密钥可不修改<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stale-nonce</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cert=/usr/local/etc/turn_server_cert.pem</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pkey=/usr/local/etc/turn_server_pkey.pem</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;no-loopback-peers</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;no-multicast-peers</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mobility</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;no-cli</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 3、生成签名证书</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sudo openssl req -x509 -newkey&nbsp; rsa:2048 -keyout/usr/local/etc/turn_server_pkey.pem&nbsp;-out&nbsp;/usr/local/etc/turn_server_cert.pem&nbsp;-days 99999 -nodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size:18px;">4、启动</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; service coturn start</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">五、coTurn连接信息接口</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TURN REST API&nbsp;<a target="_blank" href="http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00" style="color:#336699;text-decoration:none;">标准参考文档</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回json结果示例：</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {"username":"1456904882:1231244","password":"jAph7EHMLuPJuxLLC1uRiI3kvq4=","ttl":86400,"uris":["turn:192.168.214.129:3478?transport=udp","turn:192.168.214.129:3478?transport=tcp","turn:192.168.214.129:3479?transport=udp","turn:192.168.214.129:3479?transport=tcp"]}</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、username字段需要以timestamp + ":"&nbsp; + username的形式输出</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、响应的 password 字段，需要以 HMAC-SHA1 算法计算得出，<strong>公式为：【base64_encode( hmac( key,<br />
</strong></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>username ) )】</strong>。</strong>此处的 key，为 coTurn 服务器配置中的 “static-auth-secret”值。以 key 作为&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hmac 算法的密钥，turn-username 为被计算的内容，得出的 hmac 摘要后，经 base64 编码得到最终密码。</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3、uris为后台配置好的，我这里写死</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4、很简单的接口，用惯了java，这里我准备用php，写起来比java快</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<div class="dp-highlighter bg_html" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:#e7e5dc;width:700.906px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;margin:18px 0px !important;"><div class="bar" style="padding-left:45px;"><div class="tools" style="padding:3px 8px 10px 10px;font-variant-ligatures:normal;font-variant-position:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-variant-east-asian:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:#f8f8f8;border-left-width:3px;border-left-style:solid;border-left-color:#6ce26c;"><b>[html]</b>&nbsp;<a href="http://blog.csdn.net/s569646547/article/details/50780682#" class="ViewSource" title="view plain" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_plain.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/s569646547/article/details/50780682#" class="CopyToClipboard" title="copy" style="color:#a0a0a0;text-decoration:none;background-image:url(file:///Applications/mNote.app/Contents/Resources/images/default/ico_copy.gif);background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat no-repeat;">copy</a><div style="position:absolute;left:818px;top:5028px;width:18px;height:18px;z-index:99;"><embed id="ZeroClipboardMovie_1" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=18&amp;height=18" wmode="transparent" /></div>
</span><span data-mod="popu_169">&nbsp;</span><span class="tracking-ad" data-mod="popu_167"><a href="https://code.csdn.net/snippets/1594938" target="_blank" title="在CODE上查看代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/CODE_ico.png" width="12" height="12" alt="在CODE上查看代码片" style="border:none;position:relative;top:1px;left:2px;" /></a></span><span class="tracking-ad" data-mod="popu_170"><a href="https://code.csdn.net/snippets/1594938/fork" target="_blank" title="派生到我的代码片" style="color:#a0a0a0;text-decoration:none;background-image:none;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;display:inline-block;width:16px;height:16px;background-position:0% 0%;background-repeat:no-repeat no-repeat;"><img src="https://code.csdn.net/assets/ico_fork.svg" width="12" height="12" alt="派生到我的代码片" style="border:none;position:relative;top:2px;left:2px;" /></a></span></div>
</div>
<ol start="1" class="dp-xml" style="padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#ffffff;color:#5c5c5c;margin:0px 0px 1px 45px !important;"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&lt;?</span><span class="tag-name" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">php</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">request_username</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$_GET["username"];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($request_username))&nbsp;{&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">username</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;==&nbsp;null";&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">request_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$_GET["key"];&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">time_to_live</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">600</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">timestamp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">time</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">()&nbsp;+&nbsp;$time_to_live;//失效时间&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">response_username</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$timestamp.":".$_GET["username"];&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">response_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$request_key;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($response_key))&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">response_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"密钥"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;//constants.py中CEOD_KEY&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">response_password</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">getSignature</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">($response_username,&nbsp;$response_key);&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">jsonObj</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">new</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;Response();&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$jsonObj-<span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&gt;</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">username</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$response_username;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$jsonObj-<span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&gt;</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">password</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;$response_password;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$jsonObj-<span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&gt;</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">ttl</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">86400</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;$jsonObj-<span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&gt;</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">uris</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">array</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">("turn:192.168.214.129:3478?</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">transport</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">=udp","</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">turn</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:192.168.214.129:3478?</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">transport</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">=tcp","</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">turn</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:192.168.214.129:3479?</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">transport</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">=udp","</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">turn</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:192.168.214.129:3479?</span><span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">transport</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">=</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">tcp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">");&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($jsonObj);&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;使用HMAC-SHA1算法生成签名值&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$str&nbsp;源串&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$key&nbsp;密钥&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;签名值&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;getSignature($str,&nbsp;$key)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">signature</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">""</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(function_exists('hash_hmac'))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">signature</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">base64_encode</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(hash_hmac("sha1",&nbsp;$str,&nbsp;$key,&nbsp;true));&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">blocksize</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">64</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">hashfunc</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'sha1'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strlen($key)&nbsp;<span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;$blocksize)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">pack</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">('H*',&nbsp;$hashfunc($key));&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">str_pad</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">($key,&nbsp;$blocksize,&nbsp;chr(0x00));&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">ipad</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">str_repeat</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(chr(0x36),&nbsp;$blocksize);&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">opad</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">str_repeat</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(chr(0x5c),&nbsp;$blocksize);&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">hmac</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">pack</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'H*',&nbsp;$hashfunc(&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($key&nbsp;^&nbsp;$opad)&nbsp;.&nbsp;pack(&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'H*',&nbsp;$hashfunc(&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($key&nbsp;^&nbsp;$ipad)&nbsp;.&nbsp;$str&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">signature</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">base64_encode</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">($hmac);&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$signature;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Response&nbsp;{&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">username</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">""</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">password</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">""</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">ttl</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">""</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$<span class="attribute" style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">uris</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="attribute-value" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">array</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">("");&nbsp;&nbsp;</span></span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li>
<li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;color:inherit;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;</span></li>
<li class="" style="border-style:none none none solid;border-left-width:3px;border-left-color:#6ce26c;list-style:decimal-leading-zero outside;background-color:#f8f8f8;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="tag" style="margin:0px;padding:0px;border:none;color:#993300;background-color:inherit;font-weight:bold;">?&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<br style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;" />
<span style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5、拿nginx部署下，怎么部署自行百度</span><p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">六、测试</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 部署成功后可在浏览器输入http://192.168.214.129:8080创建房间</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appRTCDemo连接也改成http://192.168.214.129:8080即可<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">七、参考连接</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="_blank" href="http://www.mamicode.com/info-detail-513556.html" style="color:#336699;text-decoration:none;">http://www.mamicode.com/info-detail-513556.html</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="_blank" href="http://www.jianshu.com/p/c55ecf5a3fcf" style="color:#336699;text-decoration:none;">http://www.jianshu.com/p/c55ecf5a3fcf</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="_blank" href="http://www.bubuko.com/infodetail-938737.html" style="color:#336699;text-decoration:none;">http://www.bubuko.com/infodetail-938737.html</a>l<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">八、关于webrtc编译<br />
</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 我只编译了<a href="http://lib.csdn.net/base/15" class="replace_word" title="undefined" target="_blank" style="color:#df3434;text-decoration:none;font-weight:bold;">Android</a>的版本，公司网速慢死，找了个国内下好的代码，分享到网盘了<a target="_blank" href="http://pan.baidu.com/s/1kUyNE55" style="color:#336699;text-decoration:none;">http://pan.baidu.com/s/1kUyNE55</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AppRTCDemo的工程源码连接:<a target="_blank" href="http://download.csdn.net/detail/s569646547/9451013" style="color:#336699;text-decoration:none;">AppRTCDemo工程源码</a></span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 运行截图：</span></p>
<p style="color:#333333;font-variant-ligatures:normal;orphans:2;widows:2;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="http://img.blog.csdn.net/20160302182354507?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none;" /></span><br />
</p>
<div><span style="font-size:18px;"><br />
</span></div>
</div></body></html>