<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content=mNote Mac 2.5.11"/><meta name="created" content="2017-05-15T02:59:17Z"/><meta name="updated" content="2017-05-15T02:59:28Z"/><title>Redis中的批量删除数据库中的Key</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">本文参考:<a href="http://blog.csdn.net/spring21st/article/details/15771861" target="_blank" style="margin:0px;padding:0px;color:black;">http://blog.csdn.net/spring21st/article/details/15771861</a></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><a href="http://www.cnblogs.com/DreamDrive/p/%20http://stackoverflow.com/questions/5756067/how-to-empty-a-redis-database" target="_blank" style="margin:0px;padding:0px;color:black;">&nbsp;http://stackoverflow.com/questions/5756067/how-to-empty-a-redis-database</a></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><a href="http://www.cnblogs.com/DreamDrive/p/%20http://stackoverflow.com/questions/4006324/how-to-atomically-delete-keys-matching-a-pattern-using-redis" target="_blank" style="margin:0px;padding:0px;color:black;">&nbsp;http://stackoverflow.com/questions/4006324/how-to-atomically-delete-keys-matching-a-pattern-using-redis</a></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">&nbsp;批量删除Key</p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">Redis 中有删除单个 Key 的指令 DEL，但好像没有批量删除 Key 的指令，不过我们可以借助 Linux 的 xargs 指令来完成这个动作</p>
<div class="cnblogs_code" style="margin:5px 0px;padding:5px;background-color:#f5f5f5;border:1px solid #cccccc;overflow:auto;font-variant-ligatures:normal;orphans:2;widows:2;font-family:'Courier New' !important;font-size:12px !important;"><pre style="margin-top:0px;margin-bottom:0px;padding:0px;white-space:pre-wrap;word-wrap:break-word;font-family:'Courier New' !important;"><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">1</span> redis-cli keys "*" | xargs redis-<span style="margin:0px;padding:0px;line-height:1.5 !important;">cli del  </span><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">2</span> <span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">//</span><span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">如果redis-cli没有设置成系统变量，需要指定redis-cli的完整路径  </span><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">3</span> <span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">//</span><span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">如：/opt/redis/redis-cli keys "*" | xargs /opt/redis/redis-cli del  </span></pre></div>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">如果要指定 Redis 数据库访问密码，使用下面的命令</p>
<div class="cnblogs_code" style="margin:5px 0px;padding:5px;background-color:#f5f5f5;border:1px solid #cccccc;overflow:auto;font-variant-ligatures:normal;orphans:2;widows:2;font-family:'Courier New' !important;font-size:12px !important;"><pre style="margin-top:0px;margin-bottom:0px;padding:0px;white-space:pre-wrap;word-wrap:break-word;font-family:'Courier New' !important;">redis-cli -a password keys "*" | xargs redis-cli -a password del </pre></div>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">如果要访问 Redis 中特定的数据库，使用下面的命令</p>
<div class="cnblogs_code" style="margin:5px 0px;padding:5px;background-color:#f5f5f5;border:1px solid #cccccc;overflow:auto;font-variant-ligatures:normal;orphans:2;widows:2;font-family:'Courier New' !important;font-size:12px !important;"><pre style="margin-top:0px;margin-bottom:0px;padding:0px;white-space:pre-wrap;word-wrap:break-word;font-family:'Courier New' !important;"><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">1</span> <span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">//</span><span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">下面的命令指定数据序号为0，即默认数据库  </span> <span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">2</span> redis-cli -n 0 keys "*" | xargs redis-cli -n 0 del</pre></div>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><img src="http://images2015.cnblogs.com/blog/610238/201608/610238-20160815110537140-1247636102.jpg" alt="" style="margin:0px;padding:0px;border:0px;max-width:900px;" /></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><img src="http://images2015.cnblogs.com/blog/610238/201608/610238-20160815110549328-2003178486.jpg" alt="" style="margin:0px;padding:0px;border:0px;max-width:900px;" /></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><img src="http://images2015.cnblogs.com/blog/610238/201608/610238-20160815110558421-1714411246.jpg" alt="" style="margin:0px;padding:0px;border:0px;max-width:900px;" /></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">删除所有Key<br style="margin:0px;padding:0px;" />
删除所有Key，可以使用Redis的flushdb和flushall命令</p>
<div class="cnblogs_code" style="margin:5px 0px;padding:5px;background-color:#f5f5f5;border:1px solid #cccccc;overflow:auto;font-variant-ligatures:normal;orphans:2;widows:2;font-family:'Courier New' !important;font-size:12px !important;"><pre style="margin-top:0px;margin-bottom:0px;padding:0px;white-space:pre-wrap;word-wrap:break-word;font-family:'Courier New' !important;"><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">1</span> <span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">//</span><span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">删除当前数据库中的所有Key  </span> <span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">2</span> <span style="margin:0px;padding:0px;line-height:1.5 !important;">flushdb  </span><span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">3</span> <span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">//</span><span style="margin:0px;padding:0px;color:#008000;line-height:1.5 !important;">删除所有数据库中的key  </span> <span style="margin:0px;padding:0px;color:#008080;line-height:1.5 !important;">4</span> flushall  </pre></div>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">&nbsp;</p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;"><strong style="margin:0px;padding:0px;">其它形式的通过redis的key删除:</strong></p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">1.</p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">如果key包含空格像：<br style="margin:0px;padding:0px;" />
a log&nbsp;message &nbsp; 　　　　message1<br style="margin:0px;padding:0px;" />
vip user 　　　&nbsp;　　　　 peter<br style="margin:0px;padding:0px;" />
vip user 　　 &nbsp; &nbsp;　　　　&nbsp;mark<br style="margin:0px;padding:0px;" />
vip user 　　　&nbsp;　　　　&nbsp;mary<br style="margin:0px;padding:0px;" />
可以通过加引号来删除<br style="margin:0px;padding:0px;" />
DEL "a log message"<br style="margin:0px;padding:0px;" />
DEL " vip user "&nbsp;<br style="margin:0px;padding:0px;" />
不过不推荐在key中使用空格,最好使用冒号来分割字段</p>
<p style="margin:10px auto;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-variant-ligatures:normal;orphans:2;widows:2;">例如vip:user:mary<br style="margin:0px;padding:0px;" />
一些文档使用下划线，按理驼峰应该也可以了<br style="margin:0px;padding:0px;" />
<br style="margin:0px;padding:0px;" />
2.<br style="margin:0px;padding:0px;" />
另外 redis 的 DEL是可以批量删除的，使用空格隔开<br style="margin:0px;padding:0px;" />
DEL key1 key2<br style="margin:0px;padding:0px;" />
会返回成功删除的个数<br style="margin:0px;padding:0px;" />
(integer) 2<br style="margin:0px;padding:0px;" />
对于有空格的key需要用引号包含起来<br style="margin:0px;padding:0px;" />
DEL ”vip user mark" "vip user mary"<br style="margin:0px;padding:0px;" />
(integer) 2</p></body></html>